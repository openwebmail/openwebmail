<tmpl_var header_template escape="none">

<tmpl_if comment>
<!--
This is the listview that appears when the user would like to export contacts. It only shows the 'select'
checkbox, but labels it as 'export' so that the user can select the xowmuids of the contacts they would
like to export. This file was created by copying the abook_listview.tmpl and changing/removing as needed.
-->
</tmpl_if>

<form action="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl" method="post" name="contactsForm" id="contactsForm">
<input type="hidden" name="action" value="addrlistview">
<input type="hidden" name="sessionid" value="<tmpl_var sessionid escape="html">">

<input type="hidden" name="folder" value="<tmpl_var folder escape="html">">
<input type="hidden" name="sort" value="<tmpl_var sort escape="html">">
<input type="hidden" name="msgdatetype" value="<tmpl_var msgdatetype escape="html">">
<input type="hidden" name="message_id" value="<tmpl_var messageid escape="html">">
<input type="hidden" name="page" value="<tmpl_var page escape="html">">
<input type="hidden" name="longpage" value="<tmpl_var longpage escape="html">">
<input type="hidden" name="searchtype" value="<tmpl_var searchtype escape="html">">
<input type="hidden" name="keyword" value="<tmpl_var keyword escape="html">">

<input type="hidden" name="abooksort" value="<tmpl_var abooksort escape="html">">
<input type="hidden" name="abooklongpage" value="<tmpl_var abooklongpage escape="html">">
<input type="hidden" name="abookcollapse" value="<tmpl_var abookcollapse escape="html">">

<input type="hidden" name="resetcollapse" value="0"><!-- set by collapse all button -->
<input type="hidden" name="showchecked" value="0"><!-- set by showchecked button -->
<input type="hidden" name="clearall" value="0"><!-- set by clearall button -->

<input type="hidden" name="mode" value="export">

<tmpl_loop xowmuidsloop>
<input type="hidden" name="xowmuid" value="<tmpl_var xowmuid escape="html">">
</tmpl_loop>

<div id="wrapper">
  <div id="header">
    <div id="titlebar">
      <div id="lefttitle">
        gettext('Export Contacts from:')
        <select name="abookfolder" onchange="document.contactsForm.submit();">
          <tmpl_loop abookfolderselectloop>
          <tmpl_if is_defaultabookfolder>
          <tmpl_if option_ALL><option value="ALL" <tmpl_if selected>selected</tmpl_if>><tmpl_unless is_writable># </tmpl_unless>gettext('All Addressbooks')<tmpl_if is_global> *</tmpl_if></option></tmpl_if>
          <tmpl_if option_global><option value="global" <tmpl_if selected>selected</tmpl_if>><tmpl_unless is_writable># </tmpl_unless>gettext('Global Addressbook')<tmpl_if is_global> *</tmpl_if></option></tmpl_if>
          <tmpl_if option_ldapcache><option value="ldapcache" <tmpl_if selected>selected</tmpl_if>><tmpl_unless is_writable># </tmpl_unless>gettext('Global LDAP Addressbook')<tmpl_if is_global> *</tmpl_if></option></tmpl_if>
          <tmpl_else>
          <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_unless is_writable># </tmpl_unless><tmpl_var label escape="html"><tmpl_if is_global> *</tmpl_if></option>
          </tmpl_if>
          </tmpl_loop>
        </select>
      </div>

      <div id="righttitle">
        gettext('<tmpl_var availablefreespace escape="html"> KB Available')
      </div>
    </div>

    <ul id="navigation">
      <li><a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrlistview&amp;message_id=<tmpl_var messageid escape="url">&amp;headers=<tmpl_var headers escape="url">&amp;attmode=simple&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" accesskey="B" class="icon" name="backlink" id="backlink" title="<tmpl_if is_abookfolderdefault><tmpl_if abookfolder_ALL>gettext('back to All Addressbooks')</tmpl_if><tmpl_if abookfolder_global>gettext('back to the Global Addressbook')</tmpl_if><tmpl_if abookfolder_ldapcache>gettext('back to the Global LDAP Addressbook')</tmpl_if><tmpl_else>gettext('back to <tmpl_var abookfolder_label escape="html">')</tmpl_if>"><tmpl_if use_texticon><tmpl_if is_abookfolderdefault><tmpl_if abookfolder_ALL>gettext('back to All Addressbooks')</tmpl_if><tmpl_if abookfolder_global>gettext('back to the Global Addressbook')</tmpl_if><tmpl_if abookfolder_ldapcache>gettext('back to the Global LDAP Addressbook')</tmpl_if><tmpl_else>gettext('back to <tmpl_var abookfolder_label escape="html">')</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="<tmpl_if is_abookfolderdefault><tmpl_if abookfolder_ALL>gettext('back to All Addressbooks')</tmpl_if><tmpl_if abookfolder_global>gettext('back to the Global Addressbook')</tmpl_if><tmpl_if abookfolder_ldapcache>gettext('back to the Global LDAP Addressbook')</tmpl_if><tmpl_else>gettext('back to <tmpl_var abookfolder_label escape="html">')</tmpl_if>"></tmpl_if></a></li>


      <tmpl_unless quotaoverlimit>
      <li><a href="javascript:void(0);" onclick="document.contactsForm.showchecked.value = 1; document.contactsForm.submit();" accesskey="H" class="icon" title="gettext('view all checked')"><tmpl_if use_texticon>gettext('view all checked')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_abookviewselected escape="html">" class="iconset_button" alt="gettext('view all checked')"></tmpl_if></a></li>
      <li><a href="javascript:void(0);" onclick="clear_all();" accesskey="P" class="icon" title="gettext('clear all checked')"><tmpl_if use_texticon>gettext('clear all checked')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_abookunselectall escape="html">" class="iconset_button" alt="gettext('clear all checked')"></tmpl_if></a></li>
      </tmpl_unless>
    </ul>
  </div> <!-- #header end -->

  <div id="content">
    <div class="paginator">
      <tmpl_if prevpage><a href="javascript:document.contactsForm.abookpage.value=<tmpl_var prevpage escape="js">; document.contactsForm.submit();" accesskey="B" class="icon" title="gettext('previous page')"><tmpl_if use_texticon><tmpl_if is_right_to_left>&gt;<tmpl_else>&lt;</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_right_to_left><tmpl_var iconset_small_arrowrighton escape="html"><tmpl_else><tmpl_var iconset_small_arrowlefton escape="html"></tmpl_if>" class="iconset_small" alt="<tmpl_if is_right_to_left>&gt;<tmpl_else>&lt;</tmpl_if>"></tmpl_if></a><tmpl_else><tmpl_if use_texticon>-<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_right_to_left><tmpl_var iconset_small_arrowrightoff escape="html"><tmpl_else><tmpl_var iconset_small_arrowleftoff escape="html"></tmpl_if>" class="iconset_small" title="gettext('no previous page')" alt="<tmpl_if is_right_to_left>&gt;<tmpl_else>&lt;</tmpl_if>"></tmpl_if></tmpl_if>
      <div class="currentPage"><tmpl_var abookpage escape="html">/<tmpl_var totalpages escape="html"></div>
      <tmpl_if nextpage><a href="javascript:document.contactsForm.abookpage.value=<tmpl_var nextpage escape="js">; document.contactsForm.submit();" accesskey="F" class="icon" title="gettext('next page')"><tmpl_if use_texticon><tmpl_if is_right_to_left>&lt;<tmpl_else>&gt;</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_right_to_left><tmpl_var iconset_small_arrowlefton escape="html"><tmpl_else><tmpl_var iconset_small_arrowrighton escape="html"></tmpl_if>" class="iconset_small" alt="<tmpl_if is_right_to_left>&lt;<tmpl_else>&gt;</tmpl_if>"></tmpl_if></a><tmpl_else><tmpl_if use_texticon>-<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_right_to_left><tmpl_var iconset_small_arrowleftoff escape="html"><tmpl_else><tmpl_var iconset_small_arrowrightoff escape="html"></tmpl_if>" class="iconset_small" title="gettext('no next page')" alt="<tmpl_if is_right_to_left>&lt;<tmpl_else>&gt;</tmpl_if>"></tmpl_if></tmpl_if>
    </div>

    <div class="contentbox">
      <div class="contentboxdata" id="searchbar">
        <select name="abooksearchtype">
          <tmpl_loop searchtypeselectloop>
          <tmpl_if option_fullname><option value="fullname" <tmpl_if selected>selected</tmpl_if>>gettext('Full Name')</option></tmpl_if>
          <tmpl_if option_nicknames><option value="nicknames" <tmpl_if selected>selected</tmpl_if>>gettext('Nicknames')</option></tmpl_if>
          <tmpl_if option_prefix><option value="prefix" <tmpl_if selected>selected</tmpl_if>>gettext('Name Prefix')</option></tmpl_if>
          <tmpl_if option_first><option value="first" <tmpl_if selected>selected</tmpl_if>>gettext('First Name')</option></tmpl_if>
          <tmpl_if option_middle><option value="middle" <tmpl_if selected>selected</tmpl_if>>gettext('Middle Name')</option></tmpl_if>
          <tmpl_if option_last><option value="last" <tmpl_if selected>selected</tmpl_if>>gettext('Last Name')</option></tmpl_if>
          <tmpl_if option_suffix><option value="suffix" <tmpl_if selected>selected</tmpl_if>>gettext('Name Suffix')</option></tmpl_if>
          <tmpl_if option_email><option value="email" <tmpl_if selected>selected</tmpl_if>>gettext('Email')</option></tmpl_if>
          <tmpl_if option_phone><option value="phone" <tmpl_if selected>selected</tmpl_if>>gettext('Phone')</option></tmpl_if>
          <tmpl_if option_note><option value="note" <tmpl_if selected>selected</tmpl_if>>gettext('Note')</option></tmpl_if>
          <tmpl_if option_categories><option value="categories" <tmpl_if selected>selected</tmpl_if>>gettext('Categories')</option></tmpl_if>
          </tmpl_loop>
        </select>

        <input type="text" name="abookkeyword" value="<tmpl_var abookkeyword escape="html">" accesskey="S" tabindex="1">
        <input type="submit" name="Search" value="gettext('Search')"><input type="submit" name="clearsearchbutton" value="gettext('Clear')" accesskey="Q">

        <input type="text" size="12" name="keyword" value="<tmpl_var keyword escape="html">" accesskey="S">

        <input type="submit" name="searchbutton" value="gettext('Search')"><input type="submit" name="clearsearchbutton" value="gettext('Clear')" accesskey="Q">

        <div class="center">
          <label for="page">gettext('Page')</label>

          <select name="abookpage" onchange="document.contactsForm.submit();">
            <tmpl_loop pageselectloop>
            <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
            </tmpl_loop>
          </select>

          <tmpl_if abooklongpage>
          <a href="javascript:document.contactsForm.abooklongpage.value = 0; document.contactsForm.submit();" title="<tmpl_var abook_addrperpagestring escape="html">">&nbsp;-&nbsp;</a>
          <tmpl_else>
          <a href="javascript:document.contactsForm.abooklongpage.value = 1; document.contactsForm.submit();" title="<tmpl_var abook_addrperpagestring escape="html">">&nbsp;+&nbsp;</a>
          </tmpl_if>
        </div>
      </div>
    </div>

    <table class="contentbox">
      <tr class="contentboxtitle">
        <th>
          <tmpl_if abookcollapse>
          <a href="javascript:document.contactsForm.resetcollapse.value = 1; document.contactsForm.abookcollapse.value = 0; document.contactsForm.submit();" accesskey="Z" class="icon" title="gettext('expand all contacts')"><tmpl_if use_texticon>&gt;<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_arrowrighton escape="html">" class="iconset_small" alt="&gt;"></tmpl_if></a>
          <tmpl_else>
          <a href="javascript:document.contactsForm.resetcollapse.value = 1; document.contactsForm.abookcollapse.value = 1; document.contactsForm.submit();" accesskey="Z" class="icon" title="gettext('collapse all contacts')"><tmpl_if use_texticon>v<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"></tmpl_if></a>
          </tmpl_if>
        </th>

        <tmpl_loop fieldorderloop>
        <th>
          <tmpl_if fullname><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>fullname<tmpl_else>fullname_rev</tmpl_if><tmpl_else>fullname</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by full name ascending')<tmpl_else>gettext('sort by full name descending')</tmpl_if>">gettext('Full Name')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if nicknames><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>nicknames<tmpl_else>nicknames_rev</tmpl_if><tmpl_else>nicknames</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by nicknames ascending')<tmpl_else>gettext('sort by nicknames descending')</tmpl_if>">gettext('Nicknames')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if prefix><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>prefix<tmpl_else>prefix_rev</tmpl_if><tmpl_else>prefix</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by name prefix ascending')<tmpl_else>gettext('sort by name prefix descending')</tmpl_if>">gettext('Prefix')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if first><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>first<tmpl_else>first_rev</tmpl_if><tmpl_else>first</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by first name ascending')<tmpl_else>gettext('sort by first name descending')</tmpl_if>">gettext('First')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if middle><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>middle<tmpl_else>middle_rev</tmpl_if><tmpl_else>middle</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by middle name ascending')<tmpl_else>gettext('sort by middle name descending')</tmpl_if>">gettext('Middle')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if last><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>last<tmpl_else>last_rev</tmpl_if><tmpl_else>last</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by last name ascending')<tmpl_else>gettext('sort by last name descending')</tmpl_if>">gettext('Last')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if suffix><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>suffix<tmpl_else>suffix_rev</tmpl_if><tmpl_else>suffix</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by name suffix ascending')<tmpl_else>gettext('sort by name suffix descending')</tmpl_if>">gettext('Suffix')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if email><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>email<tmpl_else>email_rev</tmpl_if><tmpl_else>email</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by email ascending')<tmpl_else>gettext('sort by email descending')</tmpl_if>">gettext('Email')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if phone><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>phone<tmpl_else>phone_rev</tmpl_if><tmpl_else>phone</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by phone number ascending')<tmpl_else>gettext('sort by phone number descending')</tmpl_if>">gettext('Phone')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if categories><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>categories<tmpl_else>categories_rev</tmpl_if><tmpl_else>categories</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by categories ascending')<tmpl_else>gettext('sort by categories descending')</tmpl_if>">gettext('Categories')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>

          <tmpl_if note><a href="javascript:sortby('<tmpl_if is_sort_key><tmpl_if is_sort_reverse>note<tmpl_else>note_rev</tmpl_if><tmpl_else>note</tmpl_if>');" title="<tmpl_if is_sort_reverse>gettext('sort by note ascending')<tmpl_else>gettext('sort by note descending')</tmpl_if>">gettext('Note')<tmpl_if is_sort_key>&nbsp;<tmpl_if use_texticon><tmpl_if is_sort_reverse>v<tmpl_else>^</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_sort_reverse><tmpl_var iconset_small_arrowup escape="html">" class="iconset_small" alt="^"<tmpl_else><tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"</tmpl_if>></tmpl_if></tmpl_if></a></tmpl_if>
        </th>
        </tmpl_loop>

        <th><a href="javascript:void(0);" name="xowmuid" onclick="check_all(this);" title="gettext('check/uncheck all boxes for export')">gettext('Export')</a></th>
      </tr>

      <tr class="contentboxdata">
        <tmpl_loop contactsloop>
        <tmpl_loop rows>
        <tr <tmpl_if use_lightbar>id="tr_<tmpl_var row escape="html">_<tmpl_var xowmuid escape="html">" class="<tmpl_if row_checked>rowdark<tmpl_else>rowlight</tmpl_if>" onclick="setrow(this);" onmouseover="this.className = 'rowhilite';" onmouseout="this.className = getrowclass(<tmpl_var row escape="js">,'<tmpl_var xowmuid escape="js">');"</tmpl_if>>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless>>
            <tmpl_if first_row>
            <b><tmpl_var contact_number escape="html"></b>
            <tmpl_if show_collapse>
            <input type="hidden" name="collapse_<tmpl_var xowmuid escape="html">" value="<tmpl_var collapse escape="html">">
            <tmpl_if collapse>
            <a href="javascript:void(0);" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true; document.contactsForm.elements['collapse_<tmpl_var xowmuid escape="js">'].value = 0; document.contactsForm.submit();" class="icon" title="gettext('expand this contact')"><tmpl_if use_texticon>&gt;<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_arrowrighton escape="html">" class="iconset_small" alt="&gt;"></tmpl_if></a>
            <tmpl_else>
            <a href="javascript:void(0);" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true; collapse_contact('<tmpl_var xowmuid escape="js">');" class="icon" title="gettext('collapse this contact')"><tmpl_if use_texticon>v<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_arrowdown escape="html">" class="iconset_small" alt="v"></tmpl_if></a>
            </tmpl_if>
            </tmpl_if>
            </tmpl_if>
          </td>

          <tmpl_loop cols>
          <tmpl_if empty>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless>>&nbsp;</td>
          </tmpl_if>

          <tmpl_unless empty>
          <tmpl_loop fullname>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless> nowrap="1"><a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addreditform&amp;<tmpl_if is_group>editgroupform=1&amp;</tmpl_if>rootxowmuid=<tmpl_var xowmuid escape="url">&amp;editformcaller=<tmpl_var abookfolder escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var xowmbook escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" title="gettext('edit contact in addressbook &quot;<tmpl_var xowmbook escape="html">&quot;')" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;"><tmpl_var VALUE escape="html"></a></td>
          </tmpl_loop>

          <tmpl_loop nicknames>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless> nowrap="1"><a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addreditform&amp;<tmpl_if is_group>editgroupform=1&amp;</tmpl_if>rootxowmuid=<tmpl_var xowmuid escape="url">&amp;editformcaller=<tmpl_var abookfolder escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var xowmbook escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" title="gettext('edit contact in addressbook &quot;<tmpl_var xowmbook escape="html">&quot;')" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;"><tmpl_var VALUE escape="html"></a></td>
          </tmpl_loop>

          <tmpl_loop prefix>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless> nowrap="1"><a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addreditform&amp;<tmpl_if is_group>editgroupform=1&amp;</tmpl_if>rootxowmuid=<tmpl_var xowmuid escape="url">&amp;editformcaller=<tmpl_var abookfolder escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var xowmbook escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" title="gettext('edit contact in addressbook &quot;<tmpl_var xowmbook escape="html">&quot;')" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;"><tmpl_var NAMEPREFIX escape="html"></a></td>
          </tmpl_loop>

          <tmpl_loop first>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless> nowrap="1"><a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addreditform&amp;<tmpl_if is_group>editgroupform=1&amp;</tmpl_if>rootxowmuid=<tmpl_var xowmuid escape="url">&amp;editformcaller=<tmpl_var abookfolder escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var xowmbook escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" title="gettext('edit contact in addressbook &quot;<tmpl_var xowmbook escape="html">&quot;')" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;"><tmpl_var GIVENNAME escape="html"></a></td>
          </tmpl_loop>

          <tmpl_loop middle>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless> nowrap="1"><a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addreditform&amp;<tmpl_if is_group>editgroupform=1&amp;</tmpl_if>rootxowmuid=<tmpl_var xowmuid escape="url">&amp;editformcaller=<tmpl_var abookfolder escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var xowmbook escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" title="gettext('edit contact in addressbook &quot;<tmpl_var xowmbook escape="html">&quot;')" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;"><tmpl_var ADDITIONALNAMES escape="html"></a></td>
          </tmpl_loop>

          <tmpl_loop last>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless> nowrap="1"><a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addreditform&amp;<tmpl_if is_group>editgroupform=1&amp;</tmpl_if>rootxowmuid=<tmpl_var xowmuid escape="url">&amp;editformcaller=<tmpl_var abookfolder escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var xowmbook escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" title="gettext('edit contact in addressbook &quot;<tmpl_var xowmbook escape="html">&quot;')" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;"><tmpl_var FAMILYNAME escape="html"></a></td>
          </tmpl_loop>

          <tmpl_loop suffix>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless> nowrap="1"><a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addreditform&amp;<tmpl_if is_group>editgroupform=1&amp;</tmpl_if>rootxowmuid=<tmpl_var xowmuid escape="url">&amp;editformcaller=<tmpl_var abookfolder escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var xowmbook escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" title="gettext('edit contact in addressbook &quot;<tmpl_var xowmbook escape="html">&quot;')" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;"><tmpl_var NAMESUFFIX escape="html"></a></td>
          </tmpl_loop>

          <tmpl_loop email>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless>>
            <tmpl_if is_group>
            <tmpl_if is_first>
            <tmpl_if cannot_link>
            <a href="javascript:void(0);" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true; alert('jgettext('This group contains too many members to be clicked directly. Please check the to, cc, or bcc box for this group and use the compose button.')');" title="gettext('all members')"><tmpl_if use_texticon>[oOo]<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_group escape="html">" class="iconset_small" alt="gettext('all members')"></tmpl_if>&nbsp;gettext('All Members') (<tmpl_var group_count escape="html">)</a>
            <tmpl_else>
            <a href="<tmpl_var url_cgi escape="none">/openwebmail-send.pl?action=compose&amp;compose_caller=addrlistview&amp;to=<tmpl_var email escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;" title="gettext('write mail to all group members')"><tmpl_if use_texticon>[oOo]<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_group escape="html">" class="iconset_small" alt="gettext('write mail to all group members')"></tmpl_if>&nbsp;gettext('All Members') (<tmpl_var group_count escape="html">)</a>
            </tmpl_if>
            <tmpl_else>
            <a href="<tmpl_var url_cgi escape="none">/openwebmail-send.pl?action=compose&amp;compose_caller=addrlistview&amp;to=<tmpl_var email escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;" title="gettext('write mail to group member <tmpl_var email escape="html">')"><tmpl_var VALUE escape="html"></a>
            </tmpl_if>
            <tmpl_else>
            <a href="<tmpl_var url_cgi escape="none">/openwebmail-send.pl?action=compose&amp;compose_caller=addrlistview&amp;to=<tmpl_var email escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true;" title="gettext('write mail to <tmpl_var email escape="html">')"><tmpl_var VALUE escape="html"></a>
            </tmpl_if>
          </td>
          </tmpl_loop>

          <tmpl_loop phone>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless> nowrap="1"><tmpl_var VALUE escape="html"><tmpl_if PREF> gettext('Pref')</tmpl_if><tmpl_if BBS> gettext('BBS')</tmpl_if><tmpl_if CAR> gettext('Car')</tmpl_if><tmpl_if CELL> gettext('Cell')</tmpl_if><tmpl_if FAX> gettext('Fax')</tmpl_if><tmpl_if HOME> gettext('Home')</tmpl_if><tmpl_if ISDN> gettext('ISDN')</tmpl_if><tmpl_if MODEM> gettext('Modem')</tmpl_if><tmpl_if MSG> gettext('Msg')</tmpl_if><tmpl_if PAGER> gettext('Pager')</tmpl_if><tmpl_if VIDEO> gettext('Video')</tmpl_if><tmpl_if VOICE> <!-- Voice --></tmpl_if><tmpl_if WORK> gettext('Work')</tmpl_if></td>
          </tmpl_loop>

          <tmpl_loop note>
          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless>><a href="javascript:void(0);" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true; popupNote(this,'popup_note',<tmpl_var noteoffset escape="js">,-25,'<tmpl_var VALUE escape="js">');" title="gettext('read full note')"><tmpl_var shortnote escape="none"></a></td>
          </tmpl_loop>

          </tmpl_unless>
          </tmpl_loop>

          <td <tmpl_unless use_lightbar>class="<tmpl_if odd>rowdark<tmpl_else>rowlight</tmpl_if>"</tmpl_unless> align="center"><tmpl_if first_row><input type="checkbox" name="xowmuid" value="<tmpl_var xowmuid escape="html">" <tmpl_if xowmuid_checked>checked="1"</tmpl_if> id="<tmpl_var xowmuid escape="html">" onclick="event.stopPropagation ? event.stopPropagation() : event.cancelBubble=true; setcheckbox(this);"><tmpl_else>&nbsp;</tmpl_if></td>
        </tr>
        </tmpl_loop>
        </tmpl_loop>
      </tr>
    </table>

    <div class="paginator">
      <tmpl_if prevpage><a href="javascript:document.contactsForm.abookpage.value=<tmpl_var prevpage escape="js">; document.contactsForm.submit();" accesskey="B" class="icon" title="gettext('previous page')"><tmpl_if use_texticon><tmpl_if is_right_to_left>&gt;<tmpl_else>&lt;</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_right_to_left><tmpl_var iconset_small_arrowrighton escape="html"><tmpl_else><tmpl_var iconset_small_arrowlefton escape="html"></tmpl_if>" class="iconset_small" alt="<tmpl_if is_right_to_left>&gt;<tmpl_else>&lt;</tmpl_if>"></tmpl_if></a><tmpl_else><tmpl_if use_texticon>-<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_right_to_left><tmpl_var iconset_small_arrowrightoff escape="html"><tmpl_else><tmpl_var iconset_small_arrowleftoff escape="html"></tmpl_if>" class="iconset_small" title="gettext('no previous page')" alt="<tmpl_if is_right_to_left>&gt;<tmpl_else>&lt;</tmpl_if>"></tmpl_if></tmpl_if>
      <div class="currentPage"><tmpl_var abookpage escape="html">/<tmpl_var totalpages escape="html"></div>
      <tmpl_if nextpage><a href="javascript:document.contactsForm.abookpage.value=<tmpl_var nextpage escape="js">; document.contactsForm.submit();" accesskey="F" class="icon" title="gettext('next page')"><tmpl_if use_texticon><tmpl_if is_right_to_left>&lt;<tmpl_else>&gt;</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_right_to_left><tmpl_var iconset_small_arrowlefton escape="html"><tmpl_else><tmpl_var iconset_small_arrowrighton escape="html"></tmpl_if>" class="iconset_small" alt="<tmpl_if is_right_to_left>&lt;<tmpl_else>&gt;</tmpl_if>"></tmpl_if></a><tmpl_else><tmpl_if use_texticon>-<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_if is_right_to_left><tmpl_var iconset_small_arrowleftoff escape="html"><tmpl_else><tmpl_var iconset_small_arrowrightoff escape="html"></tmpl_if>" class="iconset_small" title="gettext('no next page')" alt="<tmpl_if is_right_to_left>&lt;<tmpl_else>&gt;</tmpl_if>"></tmpl_if></tmpl_if>
    </div>

    <div class="contentbox">
      <div class="contentboxdata">
        <div class="exportcontacts_row">
          <label>gettext('Overview')</label>
          <p>
            gettext('The export system allows you to download contacts to your local computer. Follow the steps below to complete the download.')
          </p>
        </div>

        <div class="exportcontacts_row">
          <label>gettext('1. Select the contacts that you want to download from the list above.')

          <p>
            (gettext('To download an entire addressbook at one time, use the download links in the manage addressbook area:') <a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrbookedit&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;message_id=<tmpl_var messageid escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooklongpage=<tmpl_var abooklongpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" accesskey="O" class="icon" title="gettext('manage addressbooks')"><tmpl_if use_texticon>gettext('manage addressbooks')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_abooks escape="html">" class="iconset_button" alt="gettext('manage addressbooks')"></tmpl_if></a>)
          </p>
        </div>

        <div class="exportcontacts_row">
          <label>gettext('2. Select an export format:')</label> <br />

          <select name="exportformat" onchange="exportcharsettoggle(document.forms['contactsForm'].elements['exportformat'].options[document.forms['contactsForm'].elements['exportformat'].selectedIndex].value);">
            <tmpl_loop exportformatsloop>
            <tmpl_if option_vcard3.0><option value="vcard3.0" <tmpl_if selected>selected</tmpl_if>>gettext('vCard v3.0 (.vcf)')</option></tmpl_if>
            <tmpl_if option_vcard2.1><option value="vcard2.1" <tmpl_if selected>selected</tmpl_if>>gettext('vCard v2.1 (.vcf)')</option></tmpl_if>
            <tmpl_if option_csv><option value="csv" <tmpl_if selected>selected</tmpl_if>>gettext('Comma Separated Value (.csv)')</option></tmpl_if>
            <tmpl_if option_tab><option value="tab" <tmpl_if selected>selected</tmpl_if>>gettext('Tab Delimited (.tab)')</option></tmpl_if>
            </tmpl_loop>
          </select>

          <select name="exportcharset" <tmpl_if exportcharsetdisabled>disabled="1"</tmpl_if>>
            <option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('no conversion')</option>
            <tmpl_loop exportcharsetloop>
            <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
            </tmpl_loop>
          </select>
        </div>

        <div class="exportcontacts_row">
          <input type="submit" name="selectdone" value="gettext('export')">
          <input type="button" name="cancel" value="gettext('cancel')" onclick="document.location.href = document.links['backlink'].href;">
        </div>
      </div>
    </div>
    </form>
  </div> <!-- #content end -->

  <div id="popup_note"></div>

  <script type="text/javascript" src="<tmpl_var url_html escape="none">/javascript/popup_base.js"></script>
  <script type="text/javascript" src="<tmpl_var url_html escape="none">/javascript/popup_note.js"></script>
  <script type="text/javascript">
  <!--
  function exportcharsettoggle(exportformat) {
     if (exportformat == 'csv' || exportformat == 'tab') {
     for(i=0; i<document.contactsForm.elements.length; i++) {
      var e = document.contactsForm.elements[i];
      if (e.name == 'exportcharset') {
         e.disabled = 0;
      }
     }
     } else {
     for(i=0; i<document.contactsForm.elements.length; i++) {
      var e = document.contactsForm.elements[i];
      if (e.name == 'exportcharset') {
         e.disabled = 1;
      }
     }
     }
  }

  function setrow(caller) {
     // a row has been clicked: toggle the checkboxes of this row appropriately
     // caller.id: to_0_20091018-144102-QW1D6J4X2PSP-IZP9
     var caller_parts = caller.id.split('_');

     var x = document.getElementById(caller_parts[2]);

     if (!x) {
      return false; // no checkboxes
     }

     var xc = x ? x.checked : 0;

     caller.checked = 1;

     if (caller_parts[1] == 0 && xc == 0) {
      setcheckbox(caller,x); // xxx0 => xxx1
     } else if (caller_parts[1] == 0 && xc == 1) {
      caller.checked = 0;    // xxx1 => xxx0
      setcheckbox(caller,x);
     }
  }

  function setcheckbox(caller,target) {
     // set a checkbox to the same status as the caller
     // and then update the row class to toggle the row color
     // caller.id: to_0_20091018-144102-QW1D6J4X2PSP-IZP9
     var caller_parts = caller.id.split('_');

     if (!target) {
      target = caller;
     }

     for (var i=0; i<document.contactsForm.elements.length; i++) {
      var e = document.contactsForm.elements[i];
      if (e.type == 'checkbox' && e.id == target.id) {
       e.checked = caller.checked;

       var e_parts = e.id.split('_');

       if (!e_parts[2]) {
        e_parts = ['xowmuid','0',e.id];
       }

       if ((caller.type == 'checkbox' || caller_parts[0] == 'tr') && e_parts[3] == 'group' && e_parts[1] == '0') {
        check_all(caller_parts[0] == 'tr' ? e : caller);
       }

       <tmpl_if use_lightbar>
       // toggle the row color via the class assignment
       var rowid = 'tr_' + e_parts[1] + '_' + e_parts[2];
       document.getElementById(rowid).className = getrowclass(e_parts[1],e_parts[2]);
       </tmpl_if>

       break;
      }
     }
  }

  function check_all(caller) {
     // set all the checkboxes in this column or group
     // to match the checked status of the caller
     // caller.id: to_0_20091018-144102-QW1D6J4X2PSP-IZP9
     var caller_parts = caller.id.split('_');

     if (caller.type != 'checkbox') {
      caller.checked = !caller.checked; // toggle
     }

     for (var i=0; i<document.contactsForm.elements.length; i++) {
      var e = document.contactsForm.elements[i];
      if (e.type == 'checkbox' && e.name == caller.name) {
       if (caller_parts[3] == 'group') {
        // caller has an id that identifies it as part of a group
        // user is checking all group members in this to, cc, bcc column
        var e_parts = e.id.split('_');
        if (e_parts[2] == caller_parts[2] && e_parts[1] != '0') {
           // same xowmuid, same name (to,cc,bcc)
           setcheckbox(caller,e);
        }
       } else {
        // caller is not part of a group
        // user is checking all tos, ccs, or bccs in this column
        setcheckbox(caller,e);
       }
      }
     }
  }

  function getrowclass(row,id) {
     // given a row number and an id (20050223-003613-3WUTURVV6FBP-PUXA)
     // get the class of the row based on the checked or unchecked status
     // of the row members

     var is_row_checked = false;

     for (var i=0; i<document.contactsForm.elements.length; i++) {
      var e = document.contactsForm.elements[i];
      if (e.type == 'checkbox') {
       var e_parts = e.id.split('_');

       if (!e_parts[2]) {
        e_parts = ['xowmuid','0',e.id];
       }

       if (e_parts[1] == row && e_parts[2] == id) {
        is_row_checked = e.checked;
        if (is_row_checked == true) {
           break;
        }
       }
      }
     }

     return is_row_checked ? 'rowdark' : 'rowlight';
  }

  function collapse_contact(id) {
     // collapse a contact
     document.contactsForm.elements['collapse_' + id].value = 1;
     document.contactsForm.submit();
  }

  function balance_group(caller) {
     // set the all_members checkbox based on the checked or unchecked
     // status of all the group members in the same column
     // caller.id: to_0_20091018-144102-QW1D6J4X2PSP-IZP9
     var caller_parts = caller.id.split('_');

     if (caller_parts[1] != 0) {
      var all_members_checked = true;

      for (var i=0; i<document.contactsForm.elements.length; i++) {
       var e = document.contactsForm.elements[i];
       if (e.type == 'checkbox' && e.name == caller.name) {
        var e_parts = e.id.split('_');
        if (e_parts[1] != '0' && e_parts[2] == caller_parts[2]) {
           // this element is part of the group and in the same column
           all_members_checked = e.checked;
           if (all_members_checked == false) {
            break;
           }
        }
       }
      }

      // set the all_members checkbox to the result
      var all_members_id = caller.name + '_0_' + caller_parts[2] + '_group';
      for (var i=0; i<document.contactsForm.elements.length; i++) {
       var e = document.contactsForm.elements[i];
       if (e.type == 'checkbox' && e.id == all_members_id) {
        e.checked = all_members_checked;

        <tmpl_if use_lightbar>
        // toggle the row color via the class assignment
        if (!document.layers) {
           var e_parts = e.id.split('_');
           var rowid = 'tr_'+e_parts[1]+'_'+e_parts[2];
           document.getElementById(rowid).className = getrowclass(e_parts[1],e_parts[2]);
        }
        </tmpl_if>
       }
      }
     }
  }

  function sortby(sortorder) {
     // change the sorting of the addressbook listings
     // based on the given sortorder (fullname,fullname_rev,etc)
     document.contactsForm.abooksort.value = sortorder;
     document.contactsForm.abookpage.value = 1;
     document.contactsForm.submit();
  }

  function clear_all() {
     // uncheck all of the checked boxes
     if (confirm('jgettext('Are you sure you want to clear all checked boxes?')')) {
      document.contactsForm.clearall.value = 1;
      document.contactsForm.submit();
     }
  }

  <tmpl_if showchecked>
  function popup_showchecked() {
     // stylesheet is inherited from the calling document
     var html = '';
     html += '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">\n\n';
     html += '<html>\n';
     html += '<head>\n';
     html += '<meta http-equiv="Content-Type" content="text/html; charset=<tmpl_var charset escape="html">">\n';
     html += '<link rel="stylesheet" type="text/css" href="'+document.styleSheets[0].href+'">\n';
     html += '<title>jgettext('Currently Checked Addresses')</title>\n';
     html += '</head>\n';
     html += '<body style="font-size: <tmpl_var fontsize escape="html">; direction: <tmpl_var languagedirection escape="html">;">\n';
     html += '<table cellspacing="1" cellpadding="1" border="0" width="95%" align="center">\n';
     html += '<tr><td class="titlebar" colspan="2">jgettext('Currently Checked Addresses List')</td></tr>\n';
     html += '<tr><td colspan="2">&nbsp;</td></tr>\n';

     <tmpl_loop showcheckedloop>
     html += '<tr><td class="columnheader" colspan="2"><tmpl_if xowmuid>jgettext('Export')</tmpl_if></td></tr>\n';
     <tmpl_if addresses>
     <tmpl_loop addresses>
     html += '<tr>\n';
     html += '<td class="rowlight">\n';
     html += '<b><tmpl_var row escape="html"></b>\n';
     html += '</td>\n';
     html += '<td class="rowlight">\n';
     html += '<tmpl_var address escape="html">\n';
     html += '</td>\n';
     html += '</tr>\n';
     </tmpl_loop>
     <tmpl_else>
     html += '<tr><td colspan="2" class="rowlight" align="center">jgettext('none')</td></tr>\n';
     </tmpl_if>
     html += '<tr><td colspan="2">&nbsp;</td></tr>\n';
     </tmpl_loop>

     html += '<tr>\n';
     html += '<td align="center" colspan="2">\n';
     html += '<form action="#" method="post" name="showchecked">\n';
     html += '<br><input type="button" name="ok" value="jgettext('Close')" onclick="window.close();">\n';
     html += '</form>\n';
     html += '</td>\n';
     html += '</tr>\n';
     html += '</table>\n';
     html += '</body>\n';
     html += '</html>\n';

     var hWnd = window.open('', '_showchecked','width=550,height=550,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,toolbar=no');
     if (hWnd) {
      hWnd.document.open("text/html", "replace");
      hWnd.document.write(html);
      hWnd.document.close();
      hWnd.focus();
     } else {
      alert('jgettext('A popup window has been blocked.\nPlease unblock popups and try again.')');
     }
  }

  popup_showchecked();
  </tmpl_if>

  <tmpl_if clear_all>
  alert('jgettext('All checked selections have been cleared.')');
  </tmpl_if>

  document.contactsForm.abookkeyword.focus();
  document.contactsForm.abookkeyword.select();
  //-->
  </script>

  <!-- start selectdone export -->
  <tmpl_if selectdone>
  <form action="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl" method="post" name="exportForm" id="exportForm">
  <input type="hidden" name="action" value="addrexport">
  <input type="hidden" name="sessionid" value="<tmpl_var sessionid escape="html">">

  <input type="hidden" name="exportformat" value="<tmpl_var exportformat escape="html">">
  <input type="hidden" name="exportcharset" value="<tmpl_var exportcharset escape="html">">

  <tmpl_loop exportxowmuidsloop>
  <input type="hidden" name="xowmuid" value="<tmpl_var xowmuid escape="html">">
  </tmpl_loop>
  </form>

  <script type="text/javascript">
  <!--
  <tmpl_if exportxowmuidsloop>
  document.exportForm.submit(); // initiate the download of export data
  <tmpl_else>
  alert('jgettext('No contacts have been selected for export')');
  </tmpl_if>
  // -->
  </script>
  </tmpl_if>
  <!-- end of selectdone export -->

<tmpl_var footer_template escape="none">
