<tmpl_var header_template escape="none">

<div id="wrapper">
	<div id="content">
		<div class="contentbox">
			<div class="titlebar">gettext('Change Password')</div>
			
			<div class="contentboxdata center">
				<form action="<tmpl_var url_chpwd>/openwebmail-prefs.pl" method="post" name="passwordform">
				<input type="hidden" name="action" value="changepassword">
				<input type="hidden" name="sessionid" value="<tmpl_var sessionid escape="html">">
				<input type="hidden" name="folder" value="<tmpl_var folder escape="html">">
				<input type="hidden" name="message_id" value="<tmpl_var message_id escape="html">">
				<input type="hidden" name="sort" value="<tmpl_var sort escape="html">">
				<input type="hidden" name="page" value="<tmpl_var page escape="html">">
				<input type="hidden" name="longpage" value="<tmpl_var longpage escape="html">">
				<input type="hidden" name="userfirsttime" value="<tmpl_var userfirsttime escape="html">">
				<input type="hidden" name="prefs_caller" value="<tmpl_var prefs_caller escape="html">">	
				
				<div class="editpass_row">
					<label for="loginname">gettext('UserID:')</label>
					
					<input type="text" size="20" name="loginname" value="<tmpl_var loginnametext escape="html">" disabled="1">					
				</div>
				
				<div class="editpass_row">
					<label for="password">gettext('Old Password:')</label>
					
					<input type="password" size="20" name="oldpassword" value="">
				</div>
				
				<div class="editpass_row">
					<label for="newpassword">gettext('New Password:')</label>
					
					<input type="password" size="20" name="newpassword" value="">
				</div>
				
				<div class="editpass_row">
					<label for="confirmnewpassword">gettext('Confirm New Password:')</label>
					
					<input type="password" size="20" name="confirmnewpassword" value="">
				</div>
			</div>
		</div>
		
		<div class="contentbox">
			<div class="contentboxdata center">
				<div class="contentboxdata_submit">
					<input type="submit" name="passwordformsubmit" value="gettext('Change Password')" onclick="return changecheck();">
					</form>
				</div>
				
				<div class="contentboxdata_submit">
					<form action="<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl" method="post" name="cancelform">
						<input type="hidden" name="action" value="editprefs">
						<input type="hidden" name="sessionid" value="<tmpl_var sessionid escape="html">">
						<input type="hidden" name="folder" value="<tmpl_var folder escape="html">">
						<input type="hidden" name="message_id" value="<tmpl_var message_id escape="html">">
						<input type="hidden" name="sort" value="<tmpl_var sort escape="html">">
						<input type="hidden" name="page" value="<tmpl_var page escape="html">">
						<input type="hidden" name="longpage" value="<tmpl_var longpage escape="html">">
						<input type="hidden" name="userfirsttime" value="<tmpl_var userfirsttime escape="html">">
						<input type="hidden" name="prefs_caller" value="<tmpl_var prefs_caller escape="html">">
						<input type="submit" name="cancelformsubmit" value="gettext('Cancel')">
					</form>
				</div>
			</div>
		</div>
	</div> <!-- #content end -->

	<script type="text/javascript">
	<!--
	   document.passwordform.oldpassword.focus()

	   function changecheck() {
		  var s = document.passwordform.newpassword.value;
		  if (s.length < <tmpl_var passwd_minlen escape="js">) {
			 alert("jgettext('Password must have at least <tmpl_var passwd_minlen escape="js"> characters.')");
			 return false;
		  }
		  if (document.passwordform.newpassword.value != document.passwordform.confirmnewpassword.value) {
			 alert("jgettext('New password confirm mismatch.')");
			 return false;
		  }
		  if (document.passwordform.newpassword.value == document.passwordform.oldpassword.value) {
			 alert("jgettext('New password is the same as the old one.')");
			 return false;
		  }
		  return true;
	   }
	//-->
	</script>
	
<tmpl_var footer_template escape="none">