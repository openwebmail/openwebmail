<tmpl_var header_template escape="none">

<div class="wrapper">
   <form action="<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl" method="post" name="prefsform">
   <input type="hidden" name="action" value="saveprefs">
   <input type="hidden" name="sessionid" value="<tmpl_var sessionid escape="html">">
   <input type="hidden" name="folder" value="<tmpl_var folder escape="html">">
   <input type="hidden" name="message_id" value="<tmpl_var message_id escape="html">">
   <input type="hidden" name="sort" value="<tmpl_var sort escape="html">">
   <input type="hidden" name="page" value="<tmpl_var page escape="html">">
   <input type="hidden" name="longpage" value="<tmpl_var longpage escape="html">">
   <input type="hidden" name="userfirsttime" value="<tmpl_var userfirsttime escape="html">">
   <input type="hidden" name="prefs_caller" value="<tmpl_var prefs_caller escape="html">">

   <tmpl_loop hiddenprefsloop>
   <!-- first time users get a limited menu - all other preferences are hidden here -->
   <input type="hidden" name="<tmpl_var name>" value="<tmpl_var value escape="html">">
   </tmpl_loop>

   <div id="header">
      <div id="titlebar">
         <div id="lefttitle">gettext('User Preferences')</div>
         <div id="centertitle"><tmpl_if enable_quota><tmpl_if quotashowusage>gettext('Quota Usage:') <tmpl_var quotabytesusage> </tmpl_if><tmpl_if quotaoverthreshold>(<tmpl_var quotapercentusage>%) </tmpl_if><tmpl_else>&nbsp;</tmpl_if></div>
         <div id="righttitle"><tmpl_if userrealname><tmpl_var userrealname></tmpl_if></div>
      </div>

      <tmpl_unless userfirsttime>
      <ul id="navigation">
         <tmpl_if caller_main><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-main.pl?action=listmessages&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="B" class="icon" title="<tmpl_if is_callerfolderdefault><tmpl_if callerfoldername_INBOX>gettext('back to Inbox')</tmpl_if><tmpl_if callerfoldername_saved-messages>gettext('back to Saved folder')</tmpl_if><tmpl_if callerfoldername_sent-mail>gettext('back to Sent folder')</tmpl_if><tmpl_if callerfoldername_saved-drafts>gettext('back to Draft folder')</tmpl_if><tmpl_if callerfoldername_mail-trash>gettext('back to Trash folder')</tmpl_if><tmpl_if callerfoldername_spam-mail>gettext('back to Spam folder')</tmpl_if><tmpl_if callerfoldername_virus-mail>gettext('back to Virus folder')</tmpl_if><tmpl_else>gettext('back to <tmpl_var callerfoldername escape="html"> folder')</tmpl_if>"><tmpl_if use_texticon><tmpl_if is_callerfolderdefault><tmpl_if callerfoldername_INBOX>gettext('back to Inbox')</tmpl_if><tmpl_if callerfoldername_saved-messages>gettext('back to Saved folder')</tmpl_if><tmpl_if callerfoldername_sent-mail>gettext('back to Sent folder')</tmpl_if><tmpl_if callerfoldername_saved-drafts>gettext('back to Draft folder')</tmpl_if><tmpl_if callerfoldername_mail-trash>gettext('back to Trash folder')</tmpl_if><tmpl_if callerfoldername_spam-mail>gettext('back to Spam folder')</tmpl_if><tmpl_if callerfoldername_virus-mail>gettext('back to Virus folder')</tmpl_if><tmpl_else>gettext('back to <tmpl_var callerfoldername escape="html"> folder')</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="<tmpl_if is_callerfolderdefault><tmpl_if callerfoldername_INBOX>gettext('back to Inbox')</tmpl_if><tmpl_if callerfoldername_saved-messages>gettext('back to Saved folder')</tmpl_if><tmpl_if callerfoldername_sent-mail>gettext('back to Sent folder')</tmpl_if><tmpl_if callerfoldername_saved-drafts>gettext('back to Draft folder')</tmpl_if><tmpl_if callerfoldername_mail-trash>gettext('back to Trash folder')</tmpl_if><tmpl_if callerfoldername_spam-mail>gettext('back to Spam folder')</tmpl_if><tmpl_if callerfoldername_virus-mail>gettext('back to Virus folder')</tmpl_if><tmpl_else>gettext('back to <tmpl_var callerfoldername escape="html"> folder')</tmpl_if>"></tmpl_if></a></li></tmpl_if>

         <tmpl_if caller_read><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-read.pl?action=readmessage&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">" accesskey="B" class="icon" title="gettext('back to message reading')"><tmpl_if use_texticon>gettext('back to message reading')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="gettext('back to message reading')"></tmpl_if></a></tmpl_if>

         <tmpl_if caller_calendar><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-cal.pl?action=<tmpl_var calendardefaultview escape="url">&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="B" class="icon" title="gettext('back to calendar')"><tmpl_if use_texticon>gettext('back to calendar')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="gettext('back to calendar')"></tmpl_if></a></li></tmpl_if>

         <tmpl_if caller_webdisk><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-webdisk.pl?action=showdir&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="B" class="icon" title="gettext('back to webdisk')"><tmpl_if use_texticon>gettext('back to webdisk')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="gettext('back to webdisk')"></tmpl_if></a></li></tmpl_if>

         <tmpl_if caller_addrlistview><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrlistview&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="B" class="icon" title="gettext('back to addressbook')"><tmpl_if use_texticon>gettext('back to addressbook')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="gettext('back to addressbook')"></tmpl_if></a></li></tmpl_if>

         <tmpl_if enable_webmail>
            <tmpl_if enable_editfrombook><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=editfroms&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="F" class="icon" title="gettext('edit personal email addresses')"><tmpl_if use_texticon>gettext('edit personal email addresses')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_editfroms escape="html">" class="iconset_button" alt="gettext('edit personal email addresses')"></tmpl_if></a></li></tmpl_if>

            <tmpl_if enable_stationery><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=editstat&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="S" class="icon" title="gettext('edit stationery')"><tmpl_if use_texticon>gettext('edit stationery')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_editstationery escape="html">" class="iconset_button" alt="gettext('edit stationery')"></tmpl_if></a></li></tmpl_if>

            <tmpl_if enable_pop3><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=editpop3&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="G" class="icon" title="gettext('POP3 setup')"><tmpl_if use_texticon>gettext('POP3 setup')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_pop3setup escape="html">" class="iconset_button" alt="gettext('POP3 setup')"></tmpl_if></a></li></tmpl_if>

            <tmpl_if enable_spamcheck>
            <tmpl_if enable_saprefs><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-saprefs.pl?action=editrules&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="N" class="icon" title="gettext('edit spam preferences')"><tmpl_if use_texticon>gettext('edit spam preferences')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_sapreferences escape="html">" class="iconset_button" alt="gettext('edit spam preferences')"></tmpl_if></a></li></tmpl_if>
            </tmpl_if>
         </tmpl_if>

         <tmpl_if enable_changepwd><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=editpassword&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="C" class="icon" title="gettext('change password')"><tmpl_if use_texticon>gettext('change password')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_changepassword escape="html">" class="iconset_button" alt="gettext('change password')"></tmpl_if></a></li></tmpl_if>

         <tmpl_if vdomainadmin><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-vdomain.pl?action=display_vuserlist&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="V" class="icon" title="gettext('virtual domain user management')"><tmpl_if use_texticon>gettext('virtual domain user management')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_vdusers escape="html">" class="iconset_button" alt="gettext('virtual domain user management')"></tmpl_if></a></li></tmpl_if>

         <tmpl_if enable_history><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=viewhistory&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="H" class="icon" title="gettext('view history')"><tmpl_if use_texticon>gettext('view history')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_history escape="html">" class="iconset_button" alt="gettext('view history')"></tmpl_if></a></li></tmpl_if>

         <tmpl_if enable_about><li><a href="<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=about&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" accesskey="I" class="icon" title="gettext('about <tmpl_var programname escape="html">')"><tmpl_if use_texticon>gettext('about <tmpl_var programname escape="html">')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_info escape="html">" class="iconset_button" alt="gettext('about <tmpl_var programname escape="html">')"></tmpl_if></a></li></tmpl_if>
      </ul>
      </tmpl_unless>
   </div><!-- #header end -->

   <div id="content">
      <div class="contentbox">
         <div class="contentboxtitle">gettext('Personal Information')</div>

         <div class="contentboxdata center">
            <div class="preffield">
               <label for="language">gettext('Language:')</label>
               <select name="language" accesskey="1" onchange="javascript:if (this.value != null) { window.location.href='<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=editprefs&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">&amp;charset='+document.forms['prefsform'].elements['charset'].options[document.forms['prefsform'].elements['charset'].selectedIndex].value+'&amp;language='+this.value; }"<tmpl_if disablelanguageselect> disabled="1"</tmpl_if>>
                  <tmpl_loop languageselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>

               <label for="charset">gettext('Charset:')</label>
               <select name="charset" onchange="javascript:if (this.value != null) { window.location.href='<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=editprefs&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">&amp;language='+document.forms['prefsform'].elements['language'].options[document.forms['prefsform'].elements['language'].selectedIndex].value+'&amp;charset='+this.value; }"<tmpl_if disablecharsetselect> disabled="1"</tmpl_if>>
                  <tmpl_loop charsetselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label for="timezone">gettext('TimeZone offset:')</label>

               <select name="timezone" <tmpl_if disabletimezoneselect>disabled="1"</tmpl_if>>
                  <tmpl_loop timezoneselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>
               <a href="<tmpl_var url_html escape="none">/images/system/timezone.gif" target="_timezonemap" title="gettext('show timezone map')"><tmpl_if use_texticon>gettext('show timezone map')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_earthtimezone escape="html">" class="iconset_small" alt="gettext('show timezone map')"></tmpl_if></a>
            </div>

            <div class="preffield">
               <label for="daylightsaving">gettext('Daylight Saving Time:')</label>

               <select name="daylightsaving" <tmpl_if disabledstselect>disabled="1"</tmpl_if>>
                  <tmpl_loop dstselectloop>
                  <tmpl_if option_auto><option value="auto" <tmpl_if selected>selected</tmpl_if>>gettext('Auto Selected')</option></tmpl_if>
                  <tmpl_if option_on><option value="on" <tmpl_if selected>selected</tmpl_if>>gettext('On')</option></tmpl_if>
                  <tmpl_if option_off><option value="off" <tmpl_if selected>selected</tmpl_if>>gettext('Off')</option></tmpl_if>
                  </tmpl_loop>
               </select>
            </div>

            <!-- start enable_webmail options-->
            <tmpl_if enable_webmail>
            <div class="preffield">
               <label for="email">gettext('From:')</label>

               <select name="email">
                  <tmpl_loop fromemailselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>
               <tmpl_if enable_editfrombook>
                  <a href="<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=editfroms&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" title="gettext('edit personal email addresses')"><tmpl_if use_texticon>gettext('edit personal email addresses')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_editfroms escape="html">" class="iconset_small" alt="gettext('edit personal email addresses')"></tmpl_if></a>
               </tmpl_if>
            </div>

            <div class="preffield">
               <label for="replyto">gettext('Reply-To:')</label>

               <input type="text" size="40" name="replyto" value="<tmpl_var replyto escape="html">">
            </div>

            <tmpl_if enable_setforward>
            <div class="preffield">
               <label for="forwardaddress">gettext('Forward mail to:')</label>

               <input type="text" size="30" name="forwardaddress" value="<tmpl_var forwardaddress escape="html">">

               <input type="checkbox" name="keeplocalcopy" value="1" <tmpl_if keeplocalcopy>checked</tmpl_if>>&nbsp;gettext('Keep local copy')
            </div>
            </tmpl_if>

            <tmpl_if enable_autoreply>
            <div class="preffield">
               <label for="autoreply">gettext('Auto Reply:')</label>

               <input type="checkbox" name="autoreply" value="1" <tmpl_if autoreplychecked>checked</tmpl_if>>
               &nbsp;gettext('Subject:')&nbsp;<input type="text" size="40" name="autoreplysubject" value="<tmpl_var autoreplysubject escape="html">">
            </div>

            <div class="preffield">
               <label for="autoreplytext" class="topLabel">gettext('Auto Reply Text (500 characters or less)')</label>

               <textarea name="autoreplytext" rows="5" cols="<tmpl_var textareacolumns escape="html">" wrap="hard"><tmpl_var autoreplytext escape="html"></textarea>
            </div>
            </tmpl_if>

            <div class="preffield">
               <label for="signature" class="topLabel">gettext('Signature (500 characters or less)')</label>

               <textarea name="signature" rows="5" cols="<tmpl_var textareacolumns escape="html">" wrap="hard" <tmpl_if disablesignature>disabled="1"</tmpl_if>><tmpl_var signaturetext escape="html"></textarea>
            </div>

            </tmpl_if>
            <!-- end enable_webmail options-->
         </div>
      </div>

      <tmpl_unless userfirsttime>
      <div class="contentbox">
         <div class="contentboxtitle">gettext('Display Preference')</div>

         <div class="contentboxdata center">
            <div class="preffield">
               <label for="layout">gettext('Layout:')</label>

               <select name="layout" onchange="javascript:if (this.value != null) { window.location.href='<tmpl_var url_cgi escape="none">/openwebmail-prefs.pl?action=editprefs&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">&amp;language='+document.forms['prefsform'].elements['language'].options[document.forms['prefsform'].elements['language'].selectedIndex].value+'&amp;charset='+document.forms['prefsform'].elements['charset'].options[document.forms['prefsform'].elements['language'].selectedIndex].value+'&amp;layout='+this.value; }"<tmpl_if disablelayoutselect> disabled="1"</tmpl_if>>
                  <tmpl_loop layoutselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Style:')</label>

               <select name="style" accesskey="2" onchange="setCurrentStyle(document.forms['prefsform'].elements['style'].options[document.forms['prefsform'].elements['style'].selectedIndex].value+'.css');" <tmpl_if disablestyleselect>disabled="1"</tmpl_if>>
                  <tmpl_loop styleselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Icon set:')</label>

               <select name="iconset" <tmpl_if disableiconsetselect>disabled="1"</tmpl_if>>
                  <tmpl_loop iconsetselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Background image:')</label>

               <select name="background" onchange="seturldivvisibility(); document.prefsform.bgurl.value='';" <tmpl_if disablebackgroundselect>disabled="1"</tmpl_if>>
                  <tmpl_loop backgroundselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>


               <div id="urldiv" style="position:relative; visibility:visible;" width="100%" height="100%"><span style="font-size: 80%;">&nbsp;gettext('URL')&nbsp;</span>
                 <input type="text" size="35" name="bgurl" value="<tmpl_var bgurl escape="html">" <tmpl_if disablebgurl>disabled="1"</tmpl_if>>
               </div>
            </div>

            <div class="preffield">
               <label>gettext('Background image repeated:')</label>

               <input type="checkbox" name="bgrepeat" value="1" <tmpl_if bgrepeatchecked>checked</tmpl_if> <tmpl_if disablebgrepeat>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Font size:')</label>

               <select name="fontsize" <tmpl_if disablefontsizeselect>disabled="1"</tmpl_if>>
                  <tmpl_loop fontsizeselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Date format:')</label>

               <select name="dateformat" <tmpl_if disabledateformatselect>disabled="1"</tmpl_if>>
                  <tmpl_loop dateformatselectloop>
                    <tmpl_if option_mm/dd/yyyy><option value="mm/dd/yyyy" <tmpl_if selected>selected</tmpl_if>>gettext('mm/dd/yyyy')</option></tmpl_if>
                    <tmpl_if option_mm-dd-yyyy><option value="mm-dd-yyyy" <tmpl_if selected>selected</tmpl_if>>gettext('mm-dd-yyyy')</option></tmpl_if>
                    <tmpl_if option_mm.dd.yyyy><option value="mm.dd.yyyy" <tmpl_if selected>selected</tmpl_if>>gettext('mm.dd.yyyy')</option></tmpl_if>
                    <tmpl_if option_dd/mm/yyyy><option value="dd/mm/yyyy" <tmpl_if selected>selected</tmpl_if>>gettext('dd/mm/yyyy')</option></tmpl_if>
                    <tmpl_if option_dd-mm-yyyy><option value="dd-mm-yyyy" <tmpl_if selected>selected</tmpl_if>>gettext('dd-mm-yyyy')</option></tmpl_if>
                    <tmpl_if option_dd.mm.yyyy><option value="dd.mm.yyyy" <tmpl_if selected>selected</tmpl_if>>gettext('dd.mm.yyyy')</option></tmpl_if>
                    <tmpl_if option_yyyy/mm/dd><option value="yyyy/mm/dd" <tmpl_if selected>selected</tmpl_if>>gettext('yyyy/mm/dd')</option></tmpl_if>
                    <tmpl_if option_yyyy-mm-dd><option value="yyyy-mm-dd" <tmpl_if selected>selected</tmpl_if>>gettext('yyyy-mm-dd')</option></tmpl_if>
                    <tmpl_if option_yyyy.mm.dd><option value="yyyy.mm.dd" <tmpl_if selected>selected</tmpl_if>>gettext('yyyy.mm.dd')</option></tmpl_if>
                  </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Hour format:')</label>

               <select name="hourformat" <tmpl_if disablehourformatselect>disabled="1"</tmpl_if>>
                  <tmpl_loop hourformatselectloop>
                  <tmpl_if option_12><option value="12" <tmpl_if selected>selected</tmpl_if>>gettext('12 hour')</option></tmpl_if>
                  <tmpl_if option_24><option value="24" <tmpl_if selected>selected</tmpl_if>>gettext('24 hour')</option></tmpl_if>
                  </tmpl_loop>
               </select>
            </div>
         </div>
      </div>

      <tmpl_if enable_webmail>
      <div class="contentbox">
         <div class="contentboxtitle">gettext('Messages Listing')</div>
         <div class="contentboxdata">

            <div class="preffield">
               <label>gettext('Controlbar position in messages list:')</label>

               <select name="ctrlposition_folderview" accesskey="3" <tmpl_if disablectrlposselect>disabled="1"</tmpl_if>>
               <tmpl_loop ctrlposselectloop>
                 <tmpl_if option_top><option value="top" <tmpl_if selected>selected</tmpl_if>>gettext('At top')</option></tmpl_if>
                 <tmpl_if option_bottom><option value="bottom" <tmpl_if selected>selected</tmpl_if>>gettext('At bottom')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Messages per page:')</label>

               <select name="msgsperpage" <tmpl_if disablemsgsperpageselect>disabled="1"</tmpl_if>>
               <tmpl_loop msgsperpageselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Field order:')</label>

               <select name="fieldorder" <tmpl_if disablefieldorderselect>disabled="1"</tmpl_if>>
               <tmpl_loop fieldorderselectloop>
                 <tmpl_if option_date_from_subject_size><option value="date from subject size" <tmpl_if selected>selected</tmpl_if>>gettext('date from subject size')</option></tmpl_if>
                 <tmpl_if option_date_subject_from_size><option value="date subject from size" <tmpl_if selected>selected</tmpl_if>>gettext('date subject from size')</option></tmpl_if>
                 <tmpl_if option_subject_from_date_size><option value="subject from date size" <tmpl_if selected>selected</tmpl_if>>gettext('subject from date size')</option></tmpl_if>
                 <tmpl_if option_from_subject_date_size><option value="from subject date size" <tmpl_if selected>selected</tmpl_if>>gettext('from subject date size')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Default sort:')</label>

               <select name="msgsort" <tmpl_if disablemsgsortselect>disabled="1"</tmpl_if>>
               <tmpl_loop msgsortselectloop>
                 <tmpl_if option_date><option value="date" <tmpl_if selected>selected</tmpl_if>>gettext('Date (Oldest first)')</option></tmpl_if>
                 <tmpl_if option_date_rev><option value="date_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Date (Newest first)')</option></tmpl_if>
                 <tmpl_if option_sender><option value="sender" <tmpl_if selected>selected</tmpl_if>>gettext('Sender (Ascending)')</option></tmpl_if>
                 <tmpl_if option_sender_rev><option value="sender_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Sender (Decending)')</option></tmpl_if>
                 <tmpl_if option_size><option value="size" <tmpl_if selected>selected</tmpl_if>>gettext('Size (Smallest first)')</option></tmpl_if>
                 <tmpl_if option_size_rev><option value="size_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Size (Largest first)')</option></tmpl_if>
                 <tmpl_if option_subject><option value="subject" <tmpl_if selected>selected</tmpl_if>>gettext('Subject (Oldest first)')</option></tmpl_if>
                 <tmpl_if option_subject_rev><option value="subject_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Subject (Newest first)')</option></tmpl_if>
                 <tmpl_if option_status><option value="status" <tmpl_if selected>selected</tmpl_if>>gettext('Status (Unread first)')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Default search:')</label>

               <select name="searchtype" <tmpl_if disablesearchtypeselect>disabled="1"</tmpl_if>>
               <tmpl_loop searchtypeselectloop>
                 <tmpl_if option_from><option value="from" <tmpl_if selected>selected</tmpl_if>>gettext('From')</option></tmpl_if>
                 <tmpl_if option_to><option value="to" <tmpl_if selected>selected</tmpl_if>>gettext('To')</option></tmpl_if>
                 <tmpl_if option_subject><option value="subject" <tmpl_if selected>selected</tmpl_if>>gettext('Subject')</option></tmpl_if>
                 <tmpl_if option_date><option value="date" <tmpl_if selected>selected</tmpl_if>>gettext('Date')</option></tmpl_if>
                 <tmpl_if option_attfilename><option value="attfilename" <tmpl_if selected>selected</tmpl_if>>gettext('Attachment Filename')</option></tmpl_if>
                 <tmpl_if option_header><option value="header" <tmpl_if selected>selected</tmpl_if>>gettext('Header')</option></tmpl_if>
                 <tmpl_if option_textcontent><option value="textcontent" <tmpl_if selected>selected</tmpl_if>>gettext('Text Content')</option></tmpl_if>
                 <tmpl_if option_all><option value="all" <tmpl_if selected>selected</tmpl_if>>gettext('All')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Timestamp used for message date:')</label>

               <select name="msgdatetype" <tmpl_if disablemsgdatetypeselect>disabled="1"</tmpl_if>>
               <tmpl_loop msgdatetypeselectloop>
                 <tmpl_if option_sentdate><option value="sentdate" <tmpl_if selected>selected</tmpl_if>>gettext('Sent Date')</option></tmpl_if>
                 <tmpl_if option_recvdate><option value="recvdate" <tmpl_if selected>selected</tmpl_if>>gettext('Received Date')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Display mini search icon')<a title="gettext('mini search icon')"><tmpl_if use_texticon>gettext('mini search icon')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_minisearch escape="html">" class="iconset_small" alt="gettext('mini search icon')"></tmpl_if></a>:</label>

               <input type="checkbox" name="useminisearchicon" value="1" <tmpl_if useminisearchiconchecked>checked</tmpl_if> <tmpl_if disableuseminisearchicon>disabled="1"</tmpl_if>>
            </div>
         </div>
      </div>

      <div class="contentbox">
         <div class="contentboxtitle">gettext('Message Operation')</div>
         <div class="contentboxdata">
            <div class="preffield">
               <label>gettext('Confirm before message move/copy:')</label>

               <input type="checkbox" name="confirmmsgmovecopy" value="1" accesskey="4" <tmpl_if confirmmsgmovecopychecked>checked</tmpl_if> <tmpl_if disableconfirmmsgmovecopy>disabled="1"</tmpl_if>>
            </div>


            <div class="preffield">
               <label>gettext('Default destination folder:')</label>

               <select name="defaultdestination" <tmpl_if disabledefaultdestinationselect>disabled="1"</tmpl_if>>
               <tmpl_loop defaultdestinationselectloop>
                 <tmpl_if option_saved-messages><option value="saved-messages" <tmpl_if selected>selected</tmpl_if>>gettext('Saved')</option></tmpl_if>
                 <tmpl_if option_mail-trash><option value="mail-trash" <tmpl_if selected>selected</tmpl_if>>gettext('Trash')</option></tmpl_if>
                 <tmpl_if option_DELETE><option value="DELETE" <tmpl_if selected>selected</tmpl_if>>gettext('--DELETE--')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Smart Destination:')</label>

               <input type="checkbox" name="smartdestination" value="1" <tmpl_if smartdestinationchecked>checked</tmpl_if> <tmpl_if disablesmartdestination>disabled="1"</tmpl_if>>
            </div>


            <div class="preffield">
               <label>gettext('View next after message move/copy:')</label>

               <input type="checkbox" name="viewnextaftermsgmovecopy" value="1" <tmpl_if viewnextaftermsgmovecopychecked>checked</tmpl_if> <tmpl_if disableviewnextaftermsgmovecopy>disabled="1"</tmpl_if>>
            </div>

            <tmpl_if enable_pop3>
            <div class="preffield">
               <label>gettext('Auto fetch POP3 at login:')</label>

               <input type="checkbox" name="autopop3" value="1" <tmpl_if autopop3checked>checked</tmpl_if> <tmpl_if disableautopop3>disabled="1"</tmpl_if>>
               <select name="autopop3wait" <tmpl_if disableautopop3waitselect>disabled="1"</tmpl_if>>
               <tmpl_loop autopop3waitselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>
            </tmpl_if>

            <div class="preffield">
               <label>gettext('Run mail filter in the background:')</label>

               <select name="bgfilterthreshold" <tmpl_if disablebgfilterthresholdselect>disabled="1"</tmpl_if>>
               <tmpl_loop bgfilterthresholdselectloop>
                 <tmpl_if option_0><option value="0" <tmpl_if selected>selected</tmpl_if>>gettext('No')</option></tmpl_if>
                 <tmpl_if option_1><option value="1" <tmpl_if selected>selected</tmpl_if>>gettext('Yes')</option></tmpl_if>
                 <tmpl_if option_20><option value="20" <tmpl_if selected>selected</tmpl_if>>gettext('Only if Inbox has more than 20 new messages')</option></tmpl_if>
                 <tmpl_if option_50><option value="50" <tmpl_if selected>selected</tmpl_if>>gettext('Only if Inbox has more than 50 new messages')</option></tmpl_if>
                 <tmpl_if option_100><option value="100" <tmpl_if selected>selected</tmpl_if>>gettext('Only if Inbox has more than 100 new messages')</option></tmpl_if>
                 <tmpl_if option_200><option value="200" <tmpl_if selected>selected</tmpl_if>>gettext('Only if Inbox has more than 200 new messages')</option></tmpl_if>
                 <tmpl_if option_500><option value="500" <tmpl_if selected>selected</tmpl_if>>gettext('Only if Inbox has more than 500 new messages')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Wait time for background mail filtering:')</label>

               <select name="bgfilterwait" <tmpl_if disablebgfilterwaitselect>disabled="1"</tmpl_if>>
               <tmpl_loop bgfilterwaitselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <tmpl_unless forced_moveoldmsgfrominbox>
            <div class="preffield">
               <label>gettext('Move inbox messages to saved folder at logout:')</label>

               <input type="checkbox" name="moveoldmsgfrominbox" value="1" <tmpl_if moveoldmsgfrominboxchecked>checked</tmpl_if> <tmpl_if disablemoveoldmsgfrominbox>disabled="1"</tmpl_if>>
            </div>
            </tmpl_unless>
         </div>
      </div>


      <div class="contentbox">
         <div class="contentboxtitle">gettext('Message Reading Options')</div>
         <div class="contentboxdata">
            <div class="preffield">
               <label>gettext('Control bar position in read interface:')</label>

               <select name="ctrlposition_msgread" accesskey="5" <tmpl_if disablectrlposition_msgreadselect>disabled="1"</tmpl_if>>
               <tmpl_loop ctrlposition_msgreadselectloop>
                 <tmpl_if option_top><option value="top" <tmpl_if selected>selected</tmpl_if>>gettext('At top')</option></tmpl_if>
                 <tmpl_if option_bottom><option value="bottom" <tmpl_if selected>selected</tmpl_if>>gettext('At bottom')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Default header display:')</label>

               <select name="headers" <tmpl_if disableheadersselect>disabled="1"</tmpl_if>>
               <tmpl_loop headersselectloop>
                 <tmpl_if option_simple><option value="simple" <tmpl_if selected>selected</tmpl_if>>gettext('Simple headers')</option></tmpl_if>
                 <tmpl_if option_all><option value="all" <tmpl_if selected>selected</tmpl_if>>gettext('All headers')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Read with message charset:')</label>

               <input type="checkbox" name="readwithmsgcharset" value="1" <tmpl_if readwithmsgcharsetchecked>checked</tmpl_if> <tmpl_if disablereadwithmsgcharset>disabled="1"</tmpl_if>>
            </div>


            <div class="preffield">
               <label>gettext('Use fixed-width font when reading messages:')</label>

               <input type="checkbox" name="usefixedfont" value="1" <tmpl_if usefixedfontchecked>checked</tmpl_if> <tmpl_if disableusefixedfont>disabled="1"</tmpl_if>>
            </div>


            <div class="preffield">
               <label>gettext('Use smiley images when reading messages:')</label>

               <input type="checkbox" name="usesmileicon" value="1" <tmpl_if usesmileiconchecked>checked</tmpl_if> <tmpl_if disableusesmileicon>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Show HTML messages as plain text:')</label>

               <input type="checkbox" name="showhtmlastext" value="1" <tmpl_if showhtmlastextchecked>checked</tmpl_if> <tmpl_if disableshowhtmlastext>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Show image attachments as links:')</label>

               <input type="checkbox" name="showimgaslink" value="1" <tmpl_if showimgaslinkchecked>checked</tmpl_if> <tmpl_if disableshowimgaslink>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Block images inside messages:')</label>

               <input type="checkbox" name="blockimages" value="1" <tmpl_if blockimageschecked>checked</tmpl_if> <tmpl_if disableblockimages>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Disable javascript inside messages:')</label>

               <input type="checkbox" name="disablejs" value="1" <tmpl_if disablejschecked>checked</tmpl_if> <tmpl_if disabledisablejs>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Disable embed/object/applet tags inside messages:')</label>

               <input type="checkbox" name="disableembcode" value="1" <tmpl_if disableembcodechecked>checked</tmpl_if> <tmpl_if disabledisableembcode>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Disable embedded links inside messages:')</label>

               <select name="disableemblink" <tmpl_if disabledisableemblinkselect>disabled="1"</tmpl_if>>
               <tmpl_loop disableemblinkselectloop>
                 <tmpl_if option_none><option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('Do not disable any embedded links')</option></tmpl_if>
                 <tmpl_if option_cgionly><option value="cgionly" <tmpl_if selected>selected</tmpl_if>>gettext('Disable embedded CGI links only')</option></tmpl_if>
                 <tmpl_if option_all><option value="all" <tmpl_if selected>selected</tmpl_if>>gettext('Disable all embedded links')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Send 'confirm reading' receipt:')</label>

               <select name="sendreceipt" <tmpl_if disablesendreceiptselect>disabled="1"</tmpl_if>>
               <tmpl_loop sendreceiptselectloop>
                 <tmpl_if option_ask><option value="ask" <tmpl_if selected>selected</tmpl_if>>gettext('Ask to confirm')</option></tmpl_if>
                 <tmpl_if option_yes><option value="yes" <tmpl_if selected>selected</tmpl_if>>gettext('Yes')</option></tmpl_if>
                 <tmpl_if option_no><option value="no" <tmpl_if selected>selected</tmpl_if>>gettext('No')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>
         </div>
      </div>

      <div class="contentbox">
         <div class="contentboxtitle">gettext('Message Composing/Sending Options')</div>
         <div class="contentboxdata">
            <div class="preffield">
               <label>gettext('Message format:')</label>

               <select name="msgformat" accesskey="6" <tmpl_if disablemsgformatselect>disabled="1"</tmpl_if>>
               <tmpl_loop msgformatselectloop>
                 <tmpl_if option_auto><option value="auto" <tmpl_if selected>selected</tmpl_if>>gettext('Auto Selected')</option></tmpl_if>
                 <tmpl_if option_text><option value="text" <tmpl_if selected>selected</tmpl_if>>gettext('Text')</option></tmpl_if>
                 <tmpl_if option_html><option value="html" <tmpl_if selected>selected</tmpl_if>>gettext('HTML')</option></tmpl_if>
                 <tmpl_if option_both><option value="both" <tmpl_if selected>selected</tmpl_if>>gettext('HTML and Text')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Size for mail edit area:')</label>

               gettext('Columns')
               <select name="editcolumns" <tmpl_if disableeditcolumnsselect>disabled="1"</tmpl_if>>
               <tmpl_loop editcolumnsselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
               gettext('Rows')
               <select name="editrows" <tmpl_if disableeditrowsselect>disabled="1"</tmpl_if>>
               <tmpl_loop editrowsselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Send button position:')</label>

               <select name="sendbuttonposition" <tmpl_if disablesendbuttonpositionselect>disabled="1"</tmpl_if>>
               <tmpl_loop sendbuttonpositionselectloop>
                 <tmpl_if option_before><option value="before" <tmpl_if selected>selected</tmpl_if>>gettext('Before mail edit area')</option></tmpl_if>
                 <tmpl_if option_after><option value="after" <tmpl_if selected>selected</tmpl_if>>gettext('After mail edit area')</option></tmpl_if>
                 <tmpl_if option_both><option value="both" <tmpl_if selected>selected</tmpl_if>>gettext('Both before and after mail edit area')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Reparagraph message before reply:')</label>

               <input type="checkbox" name="reparagraphorigmsg" value="1" <tmpl_if reparagraphorigmsgchecked>checked</tmpl_if> <tmpl_if disablereparagraphorigmsg>disabled="1"</tmpl_if>>
            </div>


            <div class="preffield">
               <label>gettext('Reply with original message:')</label>

               <select name="replywithorigmsg" <tmpl_if disablereplywithorigmsgselect>disabled="1"</tmpl_if>>
               <tmpl_loop replywithorigmsgselectloop>
                 <tmpl_if option_at_beginning><option value="at_beginning" <tmpl_if selected>selected</tmpl_if>>gettext('At beginning')</option></tmpl_if>
                 <tmpl_if option_at_end><option value="at_end" <tmpl_if selected>selected</tmpl_if>>gettext('At end')</option></tmpl_if>
                 <tmpl_if option_none><option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('Do not show original message in reply')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Signature before forwarded text:')</label>

               <input type="checkbox" name="sigbeforeforward" value="1" <tmpl_if sigbeforeforwardchecked>checked</tmpl_if> <tmpl_if disablesigbeforeforward>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Automatic CC:')</label>

               <input type="text" size="40" name="autocc" value="<tmpl_var autocctext escape="html">" <tmpl_if disableautocc>disabled="1"</tmpl_if>>
            </div>

            <tmpl_if enable_backupsent>
            <div class="preffield">
               <label>gettext('Backup outgoing message to SENT folder:')</label>

               <input type="checkbox" name="backupsentmsg" value="1" <tmpl_if backupsentmsgchecked>checked</tmpl_if> <tmpl_if disablebackupsentmsg>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Backup to current folder (if not Inbox/Draft):')</label>

               <input type="checkbox" name="backupsentoncurrfolder" value="1" <tmpl_if backupsentoncurrfolderchecked>checked</tmpl_if> <tmpl_if disablebackupsentoncurrfolder>disabled="1"</tmpl_if>>
            </div>
            </tmpl_if>

            <div class="preffield">
               <label>gettext('Charset for outgoing message:')</label>

               <select name="sendcharset" <tmpl_if disablesendcharsetselect>disabled="1"</tmpl_if>>
               <tmpl_loop sendcharsetselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>
         </div>
      </div>

      <tmpl_if enable_viruscheck>
      <div class="contentbox">
         <div class="contentboxtitle">gettext('Virus Check')</div>
         <div class="contentboxdata">
            <div class="preffield">
               <label>gettext('Messages to be checked for viruses:')</label>

               <select name="viruscheck_source" accesskey="7" <tmpl_if disableviruscheck_sourceselect>disabled="1"</tmpl_if>>
               <tmpl_loop viruscheck_sourceselectloop>
                 <tmpl_if option_all><option value="all" <tmpl_if selected>selected</tmpl_if>>gettext('All new messages in Inbox')</option></tmpl_if>
                 <tmpl_if option_pop3><option value="pop3" <tmpl_if selected>selected</tmpl_if>>gettext('Only messages fetched from a POP3 server')</option></tmpl_if>
                 <tmpl_if option_none><option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('Do not check any messages for viruses')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Maximum size of the checked messages:')</label>

               <select name="viruscheck_maxsize" <tmpl_if disableviruscheck_maxsizeselect>disabled="1"</tmpl_if>>
               <tmpl_loop viruscheck_maxsizeselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Minimum size of the body of checked messages:')</label>

               <select name="viruscheck_minbodysize" <tmpl_if disableviruscheck_minbodysizeselect>disabled="1"</tmpl_if>>
               <tmpl_loop viruscheck_minbodysizeselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>
         </div>
      </div>
      </tmpl_if>

      <tmpl_if enable_spamcheck>
      <div class="contentbox">
         <div class="contentboxtitle">gettext('Spam Check')
            <tmpl_if enable_saprefs>
            &nbsp;<a href="<tmpl_var url_cgi escape="none">/openwebmail-saprefs.pl?action=editrules&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;message_id=<tmpl_var message_id escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;userfirsttime=<tmpl_var userfirsttime escape="url">&amp;prefs_caller=<tmpl_var prefs_caller escape="url">" title="gettext('edit spam preferences')"><tmpl_if use_texticon>gettext('edit spam preferences')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_sapreferences escape="html">" class="iconset_small" alt="gettext('edit spam preferences')"></tmpl_if></a>
            </tmpl_if>
         </div>

         <div class="contentboxdata">
            <div class="preffield">
               <label>gettext('Messages to be checked for spam:')</label>

               <select name="spamcheck_source" accesskey="8" <tmpl_if disablespamcheck_sourceselect>disabled="1"</tmpl_if>>
               <tmpl_loop spamcheck_sourceselectloop>
                 <tmpl_if option_all><option value="all" <tmpl_if selected>selected</tmpl_if>>gettext('All new messages in Inbox')</option></tmpl_if>
                 <tmpl_if option_pop3><option value="pop3" <tmpl_if selected>selected</tmpl_if>>gettext('Only messages fetched from a POP3 server')</option></tmpl_if>
                 <tmpl_if option_none><option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('Do not check any messages for spam')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Maximum size of the checked messages:')</label>

               <select name="spamcheck_maxsize" <tmpl_if disablespamcheck_maxsizeselect>disabled="1"</tmpl_if>>
               <tmpl_loop spamcheck_maxsizeselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Threshold to determine Spam:')</label>

               <select name="spamcheck_threshold" <tmpl_if disablespamcheck_thresholdselect>disabled="1"</tmpl_if>>
               <tmpl_loop spamcheck_thresholdselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>
         </div>
      </div>
      </tmpl_if>

      <tmpl_if enable_smartfilter>
      <div class="contentbox">
         <div class="contentboxtitle">gettext('Message Filtering Options')</div>
         <div class="contentboxdata">
            <div class="preffield">
               <label>gettext('Limit for repeated messages:')</label>

               <select name="filter_repeatlimit" accesskey="9" <tmpl_if disablefilter_repeatlimitselect>disabled="1"</tmpl_if>>
               <tmpl_loop filter_repeatlimitselectloop>
                 <tmpl_if option>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                 <tmpl_else>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>>gettext('Do not check for repeated messages')</option>
                 </tmpl_if>
               </tmpl_loop>
               </select>
               <tmpl_if filter_repeatlimitmatchcount>
               &nbsp;(<a title="<tmpl_var filter_repeatlimitmatchdate escape="html">">gettext('Filtered:') <tmpl_var filter_repeatlimitmatchcount escape="html"></a>)
               </tmpl_if>
            </div>


            <div class="preffield">
               <label>gettext('Filter messages with bad email address formatting:')</label>

               <input type="checkbox" name="filter_badaddrformat" value="1" <tmpl_if filter_badaddrformatchecked>checked</tmpl_if> <tmpl_if disablefilter_badaddrformat>disabled="1"</tmpl_if>>
               <tmpl_if filter_badaddrformatmatchcount>
               &nbsp;(<a title="<tmpl_var filter_badaddrformatmatchdate escape="html">">gettext('Filtered:') <tmpl_var filter_badaddrformatmatchcount escape="html"></a>)
               </tmpl_if>
            </div>

            <div class="preffield">
               <label>gettext('Filter messages with faked SMTP:')</label>

               <input type="checkbox" name="filter_fakedsmtp" value="1" <tmpl_if filter_fakedsmtpchecked>checked</tmpl_if> <tmpl_if disablefilter_fakedsmtp>disabled="1"</tmpl_if>>
               <tmpl_if filter_fakedsmtpmatchcount>
               &nbsp;(<a title="<tmpl_var filter_fakedsmtpmatchdate escape="html">">gettext('Filtered:') <tmpl_var filter_fakedsmtpmatchcount escape="html"></a>)
               </tmpl_if>
            </div>


            <div class="preffield">
               <label>gettext('Filter messages with faked From field:')</label>

               <input type="checkbox" name="filter_fakedfrom" value="1" <tmpl_if filter_fakedfromchecked>checked</tmpl_if> <tmpl_if disablefilter_fakedfrom>disabled="1"</tmpl_if>>
               <tmpl_if filter_fakedfrommatchcount>
               &nbsp;(<a title="<tmpl_var filter_fakedfrommatchdate escape="html">">gettext('Filtered:') <tmpl_var filter_fakedfrommatchcount escape="html"></a>)
               </tmpl_if>
            </div>


            <div class="preffield">
               <label>gettext('Filter messages with faked exe content-type:')</label>

               <input type="checkbox" name="filter_fakedexecontenttype" value="1" <tmpl_if filter_fakedexecontenttypechecked>checked</tmpl_if> <tmpl_if disablefilter_fakedexecontenttype>disabled="1"</tmpl_if>>
               <tmpl_if filter_fakedexecontenttypematchcount>
               &nbsp;(<a title="<tmpl_var filter_fakedexecontenttypematchdate escape="html">">gettext('Filtered:') <tmpl_var filter_fakedexecontenttypematchcount escape="html"></a>)
               </tmpl_if>
            </div>
         </div>
      </div>
      </tmpl_if>
      </tmpl_if>
      <!-- end enable_webmail -->

      <tmpl_if enable_addressbook>
      <div class="contentbox">
         <div class="contentboxtitle">gettext('Addressbook Options')</div>
         <div class="contentboxdata">
            <div class="preffield">
               <label>gettext('Size for addressbook window:')</label>

               gettext('Width')
               <select name="abook_width" accesskey="0" <tmpl_if disableabook_widthselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_widthselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
               gettext('Height')
               <select name="abook_height" <tmpl_if disableabook_heightselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_heightselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Addressbook button position:')</label>

               <select name="abook_buttonposition" <tmpl_if disableabook_buttonpositionselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_buttonpositionselectloop>
                 <tmpl_if option_before><option value="before" <tmpl_if selected>selected</tmpl_if>>gettext('Before addressbook entries')</option></tmpl_if>
                 <tmpl_if option_after><option value="after" <tmpl_if selected>selected</tmpl_if>>gettext('After addressbook entries')</option></tmpl_if>
                 <tmpl_if option_both><option value="both" <tmpl_if selected>selected</tmpl_if>>gettext('Both before and after addressbook entries')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Addressbook default filter:')</label>

               gettext('Enable')&nbsp;<input type="checkbox" name="abook_defaultfilter" value="1" <tmpl_if abook_defaultfilterchecked>checked</tmpl_if> <tmpl_if disableabook_defaultfilter>disabled="1"</tmpl_if>>
               <select name="abook_defaultsearchtype" <tmpl_if disableabook_defaultsearchtypeselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_defaultsearchtypeselectloop>
                 <tmpl_if option_fullname><option value="fullname" <tmpl_if selected>selected</tmpl_if>>gettext('Full Name')</option></tmpl_if>
                 <tmpl_if option_nicknames><option value="nicknames" <tmpl_if selected>selected</tmpl_if>>gettext('Nicknames')</option></tmpl_if>
                 <tmpl_if option_email><option value="email" <tmpl_if selected>selected</tmpl_if>>gettext('Email')</option></tmpl_if>
                 <tmpl_if option_phone><option value="phone" <tmpl_if selected>selected</tmpl_if>>gettext('Phone')</option></tmpl_if>
                 <tmpl_if option_note><option value="note" <tmpl_if selected>selected</tmpl_if>>gettext('Note')</option></tmpl_if>
                 <tmpl_if option_categories><option value="categories" <tmpl_if selected>selected</tmpl_if>>gettext('Categories')</option></tmpl_if>
               </tmpl_loop>
               </select>
               <input type="text" size="16" name="abook_defaultkeyword" value="<tmpl_var abook_defaultkeywordtext escape="html">" <tmpl_if disableabook_defaultkeyword>disabled="1"</tmpl_if>></div>
            </div>

            <div class="preffield">
               <label>gettext('Addresses displayed per page:')</label>

               <select name="abook_addrperpage" <tmpl_if disableabook_addrperpageselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_addrperpageselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Display only one line per contact:')</label>

               <input type="checkbox" name="abook_collapse" value="1" <tmpl_if abook_collapsechecked>checked</tmpl_if> <tmpl_if disableabook_collapse>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Default addressbook sort order:')</label>

               <select name="abook_sort" <tmpl_if disableabook_sortselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_sortselectloop>
                 <tmpl_if option_fullname><option value="fullname" <tmpl_if selected>selected</tmpl_if>>gettext('Full Name (A to Z)')</option></tmpl_if>
                 <tmpl_if option_fullname_rev><option value="fullname_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Full Name (Z to A)')</option></tmpl_if>
                 <tmpl_if option_nicknames><option value="nicknames" <tmpl_if selected>selected</tmpl_if>>gettext('Nicknames (A to Z)')</option></tmpl_if>
                 <tmpl_if option_nicknames_rev><option value="nicknames_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Nicknames (Z to A)')</option></tmpl_if>
                 <tmpl_if option_prefix><option value="prefix" <tmpl_if selected>selected</tmpl_if>>gettext('Name Prefix (A to Z)')</option></tmpl_if>
                 <tmpl_if option_prefix_rev><option value="prefix_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Name Prefix (Z to A)')</option></tmpl_if>
                 <tmpl_if option_first><option value="first" <tmpl_if selected>selected</tmpl_if>>gettext('First Name (A to Z)')</option></tmpl_if>
                 <tmpl_if option_first_rev><option value="first_rev" <tmpl_if selected>selected</tmpl_if>>gettext('First Name (Z to A)')</option></tmpl_if>
                 <tmpl_if option_middle><option value="middle" <tmpl_if selected>selected</tmpl_if>>gettext('Middle Name (A to Z)')</option></tmpl_if>
                 <tmpl_if option_middle_rev><option value="middle_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Middle Name (Z to A)')</option></tmpl_if>
                 <tmpl_if option_last><option value="last" <tmpl_if selected>selected</tmpl_if>>gettext('Last Name (A to Z)')</option></tmpl_if>
                 <tmpl_if option_last_rev><option value="last_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Last Name (Z to A)')</option></tmpl_if>
                 <tmpl_if option_suffix><option value="suffix" <tmpl_if selected>selected</tmpl_if>>gettext('Name Suffix (A to Z)')</option></tmpl_if>
                 <tmpl_if option_suffix_rev><option value="suffix_rev" <tmpl_if selected>selected</tmpl_if>>gettext('Name Suffix (Z to A)')</option></tmpl_if>
                 <tmpl_if option_email><option value="email" <tmpl_if selected>selected</tmpl_if>>gettext('First Email Address (A to Z)')</option></tmpl_if>
                 <tmpl_if option_email_rev><option value="email_rev" <tmpl_if selected>selected</tmpl_if>>gettext('First Email Address (Z to A)')</option></tmpl_if>
                 <tmpl_if option_phone><option value="phone" <tmpl_if selected>selected</tmpl_if>>gettext('First Phone Number (ascending numeric)')</option></tmpl_if>
                 <tmpl_if option_phone_rev><option value="phone_rev" <tmpl_if selected>selected</tmpl_if>>gettext('First Phone Number (descending numeric)')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Listview field order:')</label>

               <select name="abook_listviewfieldorder" <tmpl_if disableabook_listviewfieldorderselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_listviewfieldorder0selectloop>
                 <tmpl_if option_fullname><option value="fullname" <tmpl_if selected>selected</tmpl_if>>gettext('Full Name')</option></tmpl_if>
                 <tmpl_if option_nicknames><option value="nicknames" <tmpl_if selected>selected</tmpl_if>>gettext('Nicknames')</option></tmpl_if>
                 <tmpl_if option_prefix><option value="prefix" <tmpl_if selected>selected</tmpl_if>>gettext('Prefix')</option></tmpl_if>
                 <tmpl_if option_first><option value="first" <tmpl_if selected>selected</tmpl_if>>gettext('First')</option></tmpl_if>
                 <tmpl_if option_middle><option value="middle" <tmpl_if selected>selected</tmpl_if>>gettext('Middle')</option></tmpl_if>
                 <tmpl_if option_last><option value="last" <tmpl_if selected>selected</tmpl_if>>gettext('Last')</option></tmpl_if>
                 <tmpl_if option_suffix><option value="suffix" <tmpl_if selected>selected</tmpl_if>>gettext('Suffix')</option></tmpl_if>
                 <tmpl_if option_email><option value="email" <tmpl_if selected>selected</tmpl_if>>gettext('Email')</option></tmpl_if>
                 <tmpl_if option_phone><option value="phone" <tmpl_if selected>selected</tmpl_if>>gettext('Phone')</option></tmpl_if>
                 <tmpl_if option_note><option value="note" <tmpl_if selected>selected</tmpl_if>>gettext('Note')</option></tmpl_if>
                 <tmpl_if option_none><option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('None')</option></tmpl_if>
               </tmpl_loop>
               </select>
               <select name="abook_listviewfieldorder" <tmpl_if disableabook_listviewfieldorderselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_listviewfieldorder1selectloop>
                 <tmpl_if option_fullname><option value="fullname" <tmpl_if selected>selected</tmpl_if>>gettext('Full Name')</option></tmpl_if>
                 <tmpl_if option_nicknames><option value="nicknames" <tmpl_if selected>selected</tmpl_if>>gettext('Nicknames')</option></tmpl_if>
                 <tmpl_if option_prefix><option value="prefix" <tmpl_if selected>selected</tmpl_if>>gettext('Prefix')</option></tmpl_if>
                 <tmpl_if option_first><option value="first" <tmpl_if selected>selected</tmpl_if>>gettext('First')</option></tmpl_if>
                 <tmpl_if option_middle><option value="middle" <tmpl_if selected>selected</tmpl_if>>gettext('Middle')</option></tmpl_if>
                 <tmpl_if option_last><option value="last" <tmpl_if selected>selected</tmpl_if>>gettext('Last')</option></tmpl_if>
                 <tmpl_if option_suffix><option value="suffix" <tmpl_if selected>selected</tmpl_if>>gettext('Suffix')</option></tmpl_if>
                 <tmpl_if option_email><option value="email" <tmpl_if selected>selected</tmpl_if>>gettext('Email')</option></tmpl_if>
                 <tmpl_if option_phone><option value="phone" <tmpl_if selected>selected</tmpl_if>>gettext('Phone')</option></tmpl_if>
                 <tmpl_if option_note><option value="note" <tmpl_if selected>selected</tmpl_if>>gettext('Note')</option></tmpl_if>
                 <tmpl_if option_none><option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('None')</option></tmpl_if>
               </tmpl_loop>
               </select>
               <select name="abook_listviewfieldorder" <tmpl_if disableabook_listviewfieldorderselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_listviewfieldorder2selectloop>
                 <tmpl_if option_fullname><option value="fullname" <tmpl_if selected>selected</tmpl_if>>gettext('Full Name')</option></tmpl_if>
                 <tmpl_if option_nicknames><option value="nicknames" <tmpl_if selected>selected</tmpl_if>>gettext('Nicknames')</option></tmpl_if>
                 <tmpl_if option_prefix><option value="prefix" <tmpl_if selected>selected</tmpl_if>>gettext('Prefix')</option></tmpl_if>
                 <tmpl_if option_first><option value="first" <tmpl_if selected>selected</tmpl_if>>gettext('First')</option></tmpl_if>
                 <tmpl_if option_middle><option value="middle" <tmpl_if selected>selected</tmpl_if>>gettext('Middle')</option></tmpl_if>
                 <tmpl_if option_last><option value="last" <tmpl_if selected>selected</tmpl_if>>gettext('Last')</option></tmpl_if>
                 <tmpl_if option_suffix><option value="suffix" <tmpl_if selected>selected</tmpl_if>>gettext('Suffix')</option></tmpl_if>
                 <tmpl_if option_email><option value="email" <tmpl_if selected>selected</tmpl_if>>gettext('Email')</option></tmpl_if>
                 <tmpl_if option_phone><option value="phone" <tmpl_if selected>selected</tmpl_if>>gettext('Phone')</option></tmpl_if>
                 <tmpl_if option_note><option value="note" <tmpl_if selected>selected</tmpl_if>>gettext('Note')</option></tmpl_if>
                 <tmpl_if option_none><option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('None')</option></tmpl_if>
               </tmpl_loop>
               </select>
               <select name="abook_listviewfieldorder" <tmpl_if disableabook_listviewfieldorderselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_listviewfieldorder3selectloop>
                 <tmpl_if option_fullname><option value="fullname" <tmpl_if selected>selected</tmpl_if>>gettext('Full Name')</option></tmpl_if>
                 <tmpl_if option_nicknames><option value="nicknames" <tmpl_if selected>selected</tmpl_if>>gettext('Nicknames')</option></tmpl_if>
                 <tmpl_if option_prefix><option value="prefix" <tmpl_if selected>selected</tmpl_if>>gettext('Prefix')</option></tmpl_if>
                 <tmpl_if option_first><option value="first" <tmpl_if selected>selected</tmpl_if>>gettext('First')</option></tmpl_if>
                 <tmpl_if option_middle><option value="middle" <tmpl_if selected>selected</tmpl_if>>gettext('Middle')</option></tmpl_if>
                 <tmpl_if option_last><option value="last" <tmpl_if selected>selected</tmpl_if>>gettext('Last')</option></tmpl_if>
                 <tmpl_if option_suffix><option value="suffix" <tmpl_if selected>selected</tmpl_if>>gettext('Suffix')</option></tmpl_if>
                 <tmpl_if option_email><option value="email" <tmpl_if selected>selected</tmpl_if>>gettext('Email')</option></tmpl_if>
                 <tmpl_if option_phone><option value="phone" <tmpl_if selected>selected</tmpl_if>>gettext('Phone')</option></tmpl_if>
                 <tmpl_if option_note><option value="note" <tmpl_if selected>selected</tmpl_if>>gettext('Note')</option></tmpl_if>
                 <tmpl_if option_none><option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('None')</option></tmpl_if>
               </tmpl_loop>
               </select>
               <select name="abook_listviewfieldorder" <tmpl_if disableabook_listviewfieldorderselect>disabled="1"</tmpl_if>>
               <tmpl_loop abook_listviewfieldorder4selectloop>
                 <tmpl_if option_fullname><option value="fullname" <tmpl_if selected>selected</tmpl_if>>gettext('Full Name')</option></tmpl_if>
                 <tmpl_if option_nicknames><option value="nicknames" <tmpl_if selected>selected</tmpl_if>>gettext('Nicknames')</option></tmpl_if>
                 <tmpl_if option_prefix><option value="prefix" <tmpl_if selected>selected</tmpl_if>>gettext('Prefix')</option></tmpl_if>
                 <tmpl_if option_first><option value="first" <tmpl_if selected>selected</tmpl_if>>gettext('First')</option></tmpl_if>
                 <tmpl_if option_middle><option value="middle" <tmpl_if selected>selected</tmpl_if>>gettext('Middle')</option></tmpl_if>
                 <tmpl_if option_last><option value="last" <tmpl_if selected>selected</tmpl_if>>gettext('Last')</option></tmpl_if>
                 <tmpl_if option_suffix><option value="suffix" <tmpl_if selected>selected</tmpl_if>>gettext('Suffix')</option></tmpl_if>
                 <tmpl_if option_email><option value="email" <tmpl_if selected>selected</tmpl_if>>gettext('Email')</option></tmpl_if>
                 <tmpl_if option_phone><option value="phone" <tmpl_if selected>selected</tmpl_if>>gettext('Phone')</option></tmpl_if>
                 <tmpl_if option_note><option value="note" <tmpl_if selected>selected</tmpl_if>>gettext('Note')</option></tmpl_if>
                 <tmpl_if option_none><option value="none" <tmpl_if selected>selected</tmpl_if>>gettext('None')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>
         </div>
      </div>
      </tmpl_if>
      <!-- end enable_addressbook -->

      <tmpl_if enable_calendar>
      <div class="contentbox">
         <div class="contentboxtitle">gettext('Calendar Options')</div>
         <div class="contentboxdata">
            <div class="preffield">
               <label>gettext('Default calendar view:')</label>

               <select name="calendar_defaultview" accesskey="A" <tmpl_if disablecalendar_defaultviewselect>disabled="1"</tmpl_if>>
               <tmpl_loop calendar_defaultviewselectloop>
                 <tmpl_if option_calyear><option value="calyear" <tmpl_if selected>selected</tmpl_if>>gettext('Year view')</option></tmpl_if>
                 <tmpl_if option_calmonth><option value="calmonth" <tmpl_if selected>selected</tmpl_if>>gettext('Month view')</option></tmpl_if>
                 <tmpl_if option_calweek><option value="calweek" <tmpl_if selected>selected</tmpl_if>>gettext('Week view')</option></tmpl_if>
                 <tmpl_if option_calday><option value="calday" <tmpl_if selected>selected</tmpl_if>>gettext('Day view')</option></tmpl_if>
                 <tmpl_if option_callist><option value="callist" <tmpl_if selected>selected</tmpl_if>>gettext('List view')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Holiday definition:')</label>

               <select name="calendar_holidaydef" <tmpl_if disablecalendar_holidaydefselect>disabled="1"</tmpl_if>>
               <tmpl_loop calendar_holidaydefselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Show lunar calendar labels:')</label>

               <input type="checkbox" name="calendar_showlunar" value="1" <tmpl_if calendar_showlunarchecked>checked</tmpl_if> <tmpl_if disablecalendar_showlunar>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Number of items in month view:')</label>

               <select name="calendar_monthviewnumitems" <tmpl_if disablecalendar_monthviewnumitemsselect>disabled="1"</tmpl_if>>
               <tmpl_loop calendar_monthviewnumitemsselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Week start:')</label>

               <select name="calendar_weekstart" <tmpl_if disablecalendar_weekstartselect>disabled="1"</tmpl_if>>
               <tmpl_loop calendar_weekstartselectloop>
                 <tmpl_if option_1><option value="1" <tmpl_if selected>selected</tmpl_if>>gettext('Monday')</option></tmpl_if>
                 <tmpl_if option_2><option value="2" <tmpl_if selected>selected</tmpl_if>>gettext('Tuesday')</option></tmpl_if>
                 <tmpl_if option_3><option value="3" <tmpl_if selected>selected</tmpl_if>>gettext('Wednesday')</option></tmpl_if>
                 <tmpl_if option_4><option value="4" <tmpl_if selected>selected</tmpl_if>>gettext('Thursday')</option></tmpl_if>
                 <tmpl_if option_5><option value="5" <tmpl_if selected>selected</tmpl_if>>gettext('Friday')</option></tmpl_if>
                 <tmpl_if option_6><option value="6" <tmpl_if selected>selected</tmpl_if>>gettext('Saturday')</option></tmpl_if>
                 <tmpl_if option_0><option value="0" <tmpl_if selected>selected</tmpl_if>>gettext('Sunday')</option></tmpl_if>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('Start hour:')</label>

               <select name="calendar_starthour" <tmpl_if disablecalendar_starthourselect>disabled="1"</tmpl_if>>
               <tmpl_loop calendar_starthourselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>


            <div class="preffield">
               <label>gettext('End hour:')</label>

               <select name="calendar_endhour" <tmpl_if disablecalendar_endhourselect>disabled="1"</tmpl_if>>
               <tmpl_loop calendar_endhourselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Time interval in dayview:')</label>

               <select name="calendar_interval" <tmpl_if disablecalendar_intervalselect>disabled="1"</tmpl_if>>
               <tmpl_loop calendar_intervalselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Show empty hours:')</label>

               <input type="checkbox" name="calendar_showemptyhours" value="1" <tmpl_if calendar_showemptyhourschecked>checked</tmpl_if> <tmpl_if disablecalendar_showemptyhours>disabled="1"</tmpl_if>>
            </div>

            <tmpl_if enable_webmail>
            <div class="preffield">
               <label>gettext('Event reminder check days:')</label>

               <select name="calendar_reminderdays" <tmpl_if disablecalendar_reminderdaysselect>disabled="1"</tmpl_if>>
               <tmpl_loop calendar_reminderdaysselectloop>
                 <tmpl_if option>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                 <tmpl_else>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>>gettext('None')</option>
                 </tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Reminder for global calendar events:')</label>

               <input type="checkbox" name="calendar_reminderforglobal" value="1" <tmpl_if calendar_reminderforglobalchecked>checked</tmpl_if> <tmpl_if disablecalendar_reminderforglobal>disabled="1"</tmpl_if>>
            </div>
         </div>
      </div>
      </tmpl_if>
      </tmpl_if>
      <!-- end enable_calendar -->

      <tmpl_if enable_webdisk>
      <div class="contentbox">
         <div class="contentboxtitle">gettext('WebDisk Options')</div>
         <div class="contentboxdata">

            <div class="preffield">
               <label>gettext('Number of items in directory list:')</label>

               <select name="webdisk_dirnumitems" accesskey="D" <tmpl_if disablewebdisk_dirnumitemsselect>disabled="1"</tmpl_if>>
               <tmpl_loop webdisk_dirnumitemsselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Confirm before directory/file move/copy:')</label>

               <input type="checkbox" name="webdisk_confirmmovecopy" value="1" <tmpl_if webdisk_confirmmovecopychecked>checked</tmpl_if> <tmpl_if disablewebdisk_confirmmovecopy>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Confirm before directory/file deletion:')</label>

               <input type="checkbox" name="webdisk_confirmdel" value="1" <tmpl_if webdisk_confirmdelchecked>checked</tmpl_if> <tmpl_if disablewebdisk_confirmdel>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Confirm before directory/file compress:')</label>

               <input type="checkbox" name="webdisk_confirmcompress" value="1" <tmpl_if webdisk_confirmcompresschecked>checked</tmpl_if> <tmpl_if disablewebdisk_confirmcompress>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Size for file edit window:')</label>

               gettext('Columns')
               <select name="webdisk_fileeditcolumns" <tmpl_if disablewebdisk_fileeditcolumnsselect>disabled="1"</tmpl_if>>
               <tmpl_loop webdisk_fileeditcolumnsselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
               gettext('Rows')
               <select name="webdisk_fileeditrows" <tmpl_if disablewebdisk_fileeditrowsselect>disabled="1"</tmpl_if>>
               <tmpl_loop webdisk_fileeditrowsselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>
         </div>
      </div>
      </tmpl_if>
      <!-- end enable_webdisk -->

      <div class="contentbox">
         <div class="contentboxtitle">gettext('Misc Options')</div>
         <div class="contentboxdata">
            <div class="preffield">
               <label>gettext('Default charset for file system:')</label>

               <select name="fscharset" accesskey="E" <tmpl_if disablefscharsetselect>disabled="1"</tmpl_if>>
               <tmpl_loop fscharsetselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Use lightbar for selection:')</label>

               <input type="checkbox" name="uselightbar" value="1" <tmpl_if uselightbarchecked>checked</tmpl_if> <tmpl_if disableuselightbar>disabled="1"</tmpl_if>>
            </div>

            <tmpl_if enable_webmail>
            <div class="preffield">
               <label>gettext('Use Regex in search and filterrule:')</label>

               <input type="checkbox" name="regexmatch" value="1" <tmpl_if regexmatchchecked>checked</tmpl_if> <tmpl_if disableregexmatch>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Hide folder internal data:')</label>

               <input type="checkbox" name="hideinternal" value="1" <tmpl_if hideinternalchecked>checked</tmpl_if> <tmpl_if disablehideinternal>disabled="1"</tmpl_if>>
            </div>

            <div class="preffield">
               <label>gettext('Categorized Folders list:')</label>

               <input type="checkbox" name="categorizedfolders" value="1" <tmpl_if categorizedfolderschecked>checked</tmpl_if> <tmpl_if disablecategorizedfolders>disabled="1"</tmpl_if>>&nbsp;( gettext('Category-Folder Separator') <input type="text" size="4" name="categorizedfolders_fs" value="<tmpl_var categorizedfolders_fstext escape="html">" <tmpl_if disablecategorizedfolders_fs>disabled="1"</tmpl_if>> )
            </div>

            <div class="preffield">
               <label>gettext('New mail sound notification:')</label>

               <select name="newmailsound" <tmpl_if disablenewmailsoundselect>disabled="1"</tmpl_if>>
               <tmpl_loop newmailsoundselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
               &nbsp;<a onclick="playsound('<tmpl_var url_html escape="none">/sounds', document.prefsform.newmailsound[document.prefsform.newmailsound.selectedIndex].value);" title="gettext('test sound')"><tmpl_if use_texticon>gettext('test sound')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_playsound escape="html">" class="iconset_small" alt="gettext('test sound')"></tmpl_if></a>
            </div>

            <div class="preffield">
               <label>gettext('New mail popup window notification:')</label>

               <select name="newmailwindowtime" <tmpl_if disablenewmailwindowtimeselect>disabled="1"</tmpl_if>>
               <tmpl_loop newmailwindowtimeselectloop>
                 <tmpl_if option>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                 <tmpl_else>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>>gettext('No window notification')</option>
                 </tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Sent message popup window notification:')</label>

               <select name="mailsentwindowtime" <tmpl_if disablemailsentwindowtimeselect>disabled="1"</tmpl_if>>
               <tmpl_loop mailsentwindowtimeselectloop>
                 <tmpl_if option>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                 <tmpl_else>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>>gettext('No window notification')</option>
                 </tmpl_if>
               </tmpl_loop>
               </select>
            </div>

            <tmpl_if enable_spellcheck>
            <div class="preffield">
               <label>gettext('Dictionary for spellcheck:')</label>

               <select name="dictionary" <tmpl_if disabledictionaryselect>disabled="1"</tmpl_if>>
               <tmpl_loop dictionaryselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>
            </tmpl_if>

            <div class="preffield">
               <label>gettext('Trash folder messages lifetime:')</label>

               <select name="trashreserveddays" <tmpl_if disabletrashreserveddaysselect>disabled="1"</tmpl_if>>
               <tmpl_loop trashreserveddaysselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>

            <tmpl_if enable_spamvirusreserveddays>
            <div class="preffield">
               <label>gettext('Spam/Virus folder messages lifetime:')</label>

               <select name="spamvirusreserveddays" <tmpl_if disablespamvirusreserveddaysselect>disabled="1"</tmpl_if>>
               <tmpl_loop spamvirusreserveddaysselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>
            </tmpl_if>
            </tmpl_if>
            <!-- end enable_webmail -->


            <div class="preffield">
               <label>gettext('Auto-refresh message listing:')</label>

               <select name="refreshinterval" <tmpl_if disablerefreshintervalselect>disabled="1"</tmpl_if>>
                  <tmpl_loop refreshintervalselectloop>
                  <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
                  </tmpl_loop>
               </select>
            </div>

            <div class="preffield">
               <label>gettext('Session timeout:')</label>

               <select name="sessiontimeout" <tmpl_if disablesessiontimeoutselect>disabled="1"</tmpl_if>>
               <tmpl_loop sessiontimeoutselectloop>
                 <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
               </tmpl_loop>
               </select>
            </div>
         </div>
      </div>
      </tmpl_unless>
      <!-- end userfirsttime -->

      <div class="contentbox">
         <div class="contentboxdata center" id="prefssubmit">
            <div class="contentboxdata_submit">
               <input type="submit" name="savebutton" value="gettext('Save')" accesskey="W">
               </form>
            </div>

            <tmpl_unless userfirsttime>

            <!-- start the cancel button -->
            <tmpl_if caller_main>
            <form action="<tmpl_var url_cgi escape="none">/openwebmail-main.pl" method="post" name="cancelprefsform">
            <input type="hidden" name="action" value="listmessages">
            </tmpl_if>

            <tmpl_if caller_calendar>
            <form action="<tmpl_var url_cgi escape="none">/openwebmail-cal.pl" method="post" name="cancelprefsform">
            <input type="hidden" name="action" value="<tmpl_var calendardefaultview escape="html">">
            </tmpl_if>

            <tmpl_if caller_webdisk>
            <form action="<tmpl_var url_cgi escape="none">/openwebmail-webdisk.pl" method="post" name="cancelprefsform">
            <input type="hidden" name="action" value="showdir">
            </tmpl_if>

            <tmpl_if caller_addrlistview>
            <form action="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl" method="post" name="cancelprefsform">
            <input type="hidden" name="action" value="addrlistview">
            </tmpl_if>

            <tmpl_if caller_read>
            <form action="<tmpl_var url_cgi escape="none">/openwebmail-read.pl" method="post" name="cancelprefsform">
            <input type="hidden" name="action" value="readmessage">
            </tmpl_if>

            <input type="hidden" name="sessionid" value="<tmpl_var sessionid escape="html">">
            <input type="hidden" name="folder" value="<tmpl_var folder escape="html">">
            <input type="hidden" name="message_id" value="<tmpl_var message_id escape="html">">
            <input type="hidden" name="sort" value="<tmpl_var sort escape="html">">
            <input type="hidden" name="page" value="<tmpl_var page escape="html">">
            <input type="hidden" name="longpage" value="<tmpl_var longpage escape="html">">
            <input type="hidden" name="userfirsttime" value="<tmpl_var userfirsttime escape="html">">
            <input type="hidden" name="prefs_caller" value="<tmpl_var prefs_caller escape="html">">

            <div class="contentboxdata_submit">
               <input type="submit" name="cancelbutton" value="gettext('Cancel')" accesskey="Q">
               </form>
            </div>
            </tmpl_unless>
         </div>
      </div>
   </div><!-- #content end -->

   <script type="text/javascript">
   <!--
      function seturldivvisibility() {
        if (document.getElementById) { // exclude old browsers
          var div = document.getElementById('urldiv');
          if (document.prefsform.background.value == 'USERDEFINE') {
            div.style.visibility = 'visible';
          } else {
            div.style.visibility = 'hidden';
          }
        }
      }

      function playsound(url, soundname) {
        if (soundname != "NONE" ) {
          window.open(url+"/"+soundname);
        }
      }

      function setCurrentStyle(title) {
        if (document.getElementById) { // exclude old browsers
          var i, a, main;
          for (i=0; (a = document.getElementsByTagName("link")[i]); i++) {
            if (a.getAttribute("rel").indexOf("style") != -1 && a.getAttribute("title")) {
               a.disabled = true;
               if (a.getAttribute("title") == title) {
                 a.disabled = false;
               }
            }
          }
        }
      }

      seturldivvisibility();
   //-->
   </script>

<tmpl_var footer_template escape="none">
