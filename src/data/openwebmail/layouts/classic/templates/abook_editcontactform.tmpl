<tmpl_var header_template escape="none">

<form action="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl" method="post" name="editForm" id="editForm" enctype="multipart/form-data">
<input type="hidden" name="action" value="addredit">
<input type="hidden" name="sessionid" value="<tmpl_var sessionid escape="html">">

<input type="hidden" name="folder" value="<tmpl_var folder escape="html">">
<input type="hidden" name="sort" value="<tmpl_var sort escape="html">">
<input type="hidden" name="page" value="<tmpl_var page escape="html">">
<input type="hidden" name="longpage" value="<tmpl_var longpage escape="html">">
<input type="hidden" name="searchtype" value="<tmpl_var searchtype escape="html">">
<input type="hidden" name="keyword" value="<tmpl_var keyword escape="html">">
<input type="hidden" name="msgdatetype" value="<tmpl_var msgdatetype escape="html">">
<input type="hidden" name="message_id" value="<tmpl_var messageid escape="html">">

<input type="hidden" name="abooksort" value="<tmpl_var abooksort escape="html">">
<input type="hidden" name="abookpage" value="<tmpl_var abookpage escape="html">">
<input type="hidden" name="abooklongpage" value="<tmpl_var abooklongpage escape="html">">
<input type="hidden" name="abooksearchtype" value="<tmpl_var abooksearchtype escape="html">">
<input type="hidden" name="abookkeyword" value="<tmpl_var abookkeyword escape="html">">
<input type="hidden" name="abookcollapse" value="<tmpl_var abookcollapse escape="html">">

<input type="hidden" name="rootxowmuid" value="<tmpl_var rootxowmuid escape="html">">
<input type="hidden" name="editformcaller" value="<tmpl_var editformcaller escape="html">">
<input type="hidden" name="formchange" value="">

<!-- zero traversedirection by default -->
<input type="hidden" name="targetagent" value="0<tmpl_if has_targetagent>,<tmpl_var targetagentpath escape="html"></tmpl_if>">

<input type="hidden" name="X-OWM-UID.0.VALUE" value="<tmpl_var xowmuid escape="html">">

<table cellpadding="0" cellspacing="0" border="0" align="center" width="95%">
<tr>
  <td class="titlebar">
    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
      <td class="titlebar">gettext('Edit Contact')</td>
      <td class="titlebar" align="right">
        <tmpl_if xowmuid>
        <input type="hidden" name="abookfolder" value="<tmpl_var abookfolder escape="html">">
        <tmpl_if is_abookfolderdefault><tmpl_if abookfolder_ALL>gettext('Addressbook: All Addressbooks')</tmpl_if><tmpl_if abookfolder_global>gettext('Addressbook: Global Addressbook')</tmpl_if><tmpl_if abookfolder_ldapcache>gettext('Addressbook: Global LDAP Addressbook')</tmpl_if><tmpl_else>gettext('Addressbook: <tmpl_var abookfolder_label escape="html">')</tmpl_if>
        <tmpl_else>
        <table cellspacing=0 cellpadding=0 border=0>
        <tr>
          <td class="titlebar">gettext('Destination:')&nbsp;</td>
          <td>
            <select name="abookfolder">
              <tmpl_loop writableabooksloop>
              <tmpl_if is_defaultabookfolder>
              <tmpl_if option_ALL><option value="ALL" <tmpl_if selected>selected</tmpl_if>>gettext('All Addressbooks')<tmpl_if is_global> *</tmpl_if></option></tmpl_if>
              <tmpl_if option_global><option value="global" <tmpl_if selected>selected</tmpl_if>>gettext('Global Addressbook')<tmpl_if is_global> *</tmpl_if></option></tmpl_if>
              <tmpl_if option_ldapcache><option value="ldapcache" <tmpl_if selected>selected</tmpl_if>>gettext('Global LDAP Addressbook')<tmpl_if is_global> *</tmpl_if></option></tmpl_if>
              <tmpl_else>
              <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"><tmpl_if is_global> *</tmpl_if></option>
              </tmpl_if>
              </tmpl_loop>
            </select>
          </td>
        </tr>
        </table>
        </tmpl_if>
      </td>
    </tr>
    </table>
  </td>
</tr>
<tr>
  <td class="menubar">
    <tmpl_if is_caller_readmessage>
    <a href="<tmpl_var url_cgi escape="none">/openwebmail-read.pl?action=readmessage&amp;message_id=<tmpl_var messageid escape="url">&amp;headers=<tmpl_var headers escape="url">&amp;attmode=simple&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">" accesskey="B" class="icon" title="gettext('back to message reading')"><tmpl_if use_texticon>gettext('back to message reading')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="gettext('back to message reading')"></tmpl_if></a>
    </tmpl_if>

    <tmpl_if is_caller_listmessages>
    <a href="<tmpl_var url_cgi escape="none">/openwebmail-main.pl?action=listmessages&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">" accesskey="B" class="icon" title="gettext('back to message listing')"><tmpl_if use_texticon>gettext('back to message listing')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="gettext('back to message listing')"></tmpl_if></a>
    </tmpl_if>

    <tmpl_if is_caller_ALL>
    <a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrlistview&amp;message_id=<tmpl_var messageid escape="url">&amp;headers=<tmpl_var headers escape="url">&amp;attmode=simple&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;abookfolder=ALL&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" accesskey="B" class="icon" title="gettext('back to all addressbooks')"><tmpl_if use_texticon>gettext('back to all addressbooks')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="gettext('back to all addressbooks')"></tmpl_if></a>
    </tmpl_if>

    <tmpl_if is_caller_abookfolder>
    <a href="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl?action=addrlistview&amp;message_id=<tmpl_var messageid escape="url">&amp;headers=<tmpl_var headers escape="url">&amp;attmode=simple&amp;sessionid=<tmpl_var sessionid escape="url">&amp;folder=<tmpl_var folder escape="url">&amp;page=<tmpl_var page escape="url">&amp;longpage=<tmpl_var longpage escape="url">&amp;sort=<tmpl_var sort escape="url">&amp;msgdatetype=<tmpl_var msgdatetype escape="url">&amp;keyword=<tmpl_var keyword escape="url">&amp;searchtype=<tmpl_var searchtype escape="url">&amp;abookfolder=<tmpl_var abookfolder escape="url">&amp;abookpage=<tmpl_var abookpage escape="url">&amp;abooksort=<tmpl_var abooksort escape="url">&amp;abookkeyword=<tmpl_var abookkeyword escape="url">&amp;abooksearchtype=<tmpl_var abooksearchtype escape="url">&amp;abookcollapse=<tmpl_var abookcollapse escape="url">" accesskey="B" class="icon" title="<tmpl_if is_abookfolderdefault><tmpl_if abookfolder_ALL>gettext('back to All Addressbooks')</tmpl_if><tmpl_if abookfolder_global>gettext('back to the Global Addressbook')</tmpl_if><tmpl_if abookfolder_ldapcache>gettext('back to the Global LDAP Addressbook')</tmpl_if><tmpl_else>gettext('back to <tmpl_var abookfolder_label escape="html">')</tmpl_if>"><tmpl_if use_texticon><tmpl_if is_abookfolderdefault><tmpl_if abookfolder_ALL>gettext('back to All Addressbooks')</tmpl_if><tmpl_if abookfolder_global>gettext('back to the Global Addressbook')</tmpl_if><tmpl_if abookfolder_ldapcache>gettext('back to the Global LDAP Addressbook')</tmpl_if><tmpl_else>gettext('back to <tmpl_var abookfolder_label escape="html">')</tmpl_if><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_button_back escape="html">" class="iconset_button" alt="<tmpl_if is_abookfolderdefault><tmpl_if abookfolder_ALL>gettext('back to All Addressbooks')</tmpl_if><tmpl_if abookfolder_global>gettext('back to the Global Addressbook')</tmpl_if><tmpl_if abookfolder_ldapcache>gettext('back to the Global LDAP Addressbook')</tmpl_if><tmpl_else>gettext('back to <tmpl_var abookfolder_label escape="html">')</tmpl_if>"></tmpl_if></a>
    </tmpl_if>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td class="menubar">
    <table cellpadding="0" cellspacing="0" border="0" align="center" width="100%">
    <tr>
      <td><b>&nbsp;<tmpl_loop contactpath><tmpl_if depth>&nbsp;<tmpl_if use_texticon>=&gt;<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_arrowrighton escape="html">" class="iconset_small" alt="=&gt;"></tmpl_if>&nbsp;</tmpl_if><tmpl_if newagent>gettext('New Agent')<tmpl_else><tmpl_var name escape="html"></tmpl_if></tmpl_loop></b></td>
      <td align="right">gettext('Character Set:')&nbsp;
        <select name="X-OWM-CHARSET.0.VALUE" accesskey="I" onchange="javascript:document.editForm.formchange.value='X-OWM-CHARSET,0,0'; document.editForm.submit();">
          <tmpl_loop convtoselectloop>
          <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
          </tmpl_loop>
        </select>
        <input type="hidden" name="convfrom" value="<tmpl_var composecharset escape="html">">
      </td>
    </tr>
    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
</table>

<tmpl_loop contactloop>
<table cellpadding="0" cellspacing="0" border="0" align="center" width="95%">
<tr>
  <td class="columnheader">gettext('Personal Information')</td>
</tr>
<tr>
  <td class="windowdark">
    <table cellpadding="0" cellspacing="0" border="0" width="95%" align="center">
    <tr>
      <td>&nbsp;</td>
    </tr>

    <tmpl_if PHOTO>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tmpl_loop PHOTO>
        <tr>
          <tmpl_if URI>
          <tmpl_if show_inline>
          <td><a name="PHOTO" href="<tmpl_var VALUE escape="html">" target="_new"><img src="<tmpl_var VALUE escape="html">" border="1"></a></td>
          <tmpl_else>
          <td width="52" height="52" bgcolor="#000000" align="center">
            <table cellspacing="0" cellpadding="0" border="0">
            <tr>
              <td align="center" width="50" height="50" class="rowlight">
                <a name="PHOTO" href="<tmpl_var VALUE escape="html">" target="_new" class="icon" title="<tmpl_var VALUE escape="html">"><tmpl_if use_texticon><tmpl_var VALUE escape="html"><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_link escape="html">" class="iconset_small" alt="<tmpl_var VALUE escape="html">"></tmpl_if></a>
              </td>
            </tr>
            </table>
          </td>
          </tmpl_if>
          <tmpl_else>
          <tmpl_if BASE64>
          <td>
            <a name="PHOTO" href="<tmpl_var url_cgi escape="html">/openwebmail-abook.pl?action=addrviewatt&amp;sessionid=<tmpl_var sessionid escape="html">&amp;file=<tmpl_var VALUE escape="html">&amp;type=<tmpl_var filetype escape="html">" target="_new"><img src="<tmpl_var url_cgi escape="html">/openwebmail-abook.pl?action=addrviewatt&amp;sessionid=<tmpl_var sessionid escape="html">&amp;file=<tmpl_var VALUE escape="html">&amp;type=<tmpl_var filetype escape="html">" border="1"></a>
          </td>
          <tmpl_else>
          <td>gettext('Photo could not be displayed')</td>
          </tmpl_if>
          </tmpl_if>
          <td valign="bottom">
             &nbsp;&nbsp;<a href="javascript:document.editForm.formchange.value='PHOTO,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a>
             <input type="hidden" name="PHOTO.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">">
             <tmpl_loop TYPES>
             <input type="hidden" name="PHOTO.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
             </tmpl_loop>
             <tmpl_if GROUP><input type="hidden" name="PHOTO.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">"></tmpl_if>
          </td>
        </tr>
        <tr>
          <td colspan="2">&nbsp;</td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if N>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="6"><b>gettext('Name Attributes')<font color="#ff0000"><super>*</super></font></b></td>
        </tr>
        <tmpl_loop N>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="N.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="N.<tmpl_var count escape="html">.VALUE.NAMEPREFIX" value="<tmpl_var NAMEPREFIX escape="html">" size="4" onblur="updateFN(this);">&nbsp;&nbsp;</td>
          <td><input class="mono" type="text" name="N.<tmpl_var count escape="html">.VALUE.GIVENNAME" value="<tmpl_var GIVENNAME escape="html">" size="10" onblur="updateFN(this);">&nbsp;&nbsp;</td>
          <td><input class="mono" type="text" name="N.<tmpl_var count escape="html">.VALUE.ADDITIONALNAMES" value="<tmpl_var ADDITIONALNAMES escape="html">" size="10" onblur="updateFN(this);">&nbsp;&nbsp;</td>
          <td><input class="mono" type="text" name="N.<tmpl_var count escape="html">.VALUE.FAMILYNAME" value="<tmpl_var FAMILYNAME escape="html">" size="10" onblur="updateFN(this);">&nbsp;&nbsp;</td>
          <td><input class="mono" type="text" name="N.<tmpl_var count escape="html">.VALUE.NAMESUFFIX" value="<tmpl_var NAMESUFFIX escape="html">" size="4" onblur="updateFN(this);">&nbsp;&nbsp;</td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('prefix')</td>
          <td class="smalltext">gettext('first')</td>
          <td class="smalltext">gettext('middle')</td>
          <td class="smalltext">gettext('last')</td>
          <td class="smalltext">gettext('suffix')</td>
        </tr>
        <tr>
          <td colspan="6">
            <tmpl_loop TYPES>
            <input type="hidden" name="N.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if FN>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2">
            <b>gettext('Full Name')</b>
            &nbsp;
            <tmpl_loop SOUND>
            <tmpl_if URI>
            <tmpl_if is_phonetic>
            <span class="smalltext">gettext('phonetic pronunciation:')&nbsp;<tmpl_var VALUE escape="html"></span>
            <tmpl_else>
            <a name="SOUND" href="<tmpl_var VALUE escape="html">" target="_new"><tmpl_if use_texticon>gettext('play pronunciation sound')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_playsound escape="html">" class="iconset_small" alt="gettext('play pronunciation sound')"></tmpl_if></a>
            </tmpl_if>
            <tmpl_else>
            <tmpl_if BASE64>
            <a name="SOUND" href="<tmpl_var url_cgi escape="html">/openwebmail-abook.pl?action=addrviewatt&amp;sessionid=<tmpl_var sessionid escape="html">&amp;file=<tmpl_var VALUE escape="html">&amp;type=<tmpl_var filetype escape="html">" target="_new" title="gettext('play pronunciation sound')"><tmpl_if use_texticon>gettext('play pronunciation sound')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_playsound escape="html">" class="iconset_small" alt="gettext('play pronunciation sound')"></tmpl_if></a>
            </tmpl_if>
            </tmpl_if>
            &nbsp;<a href="javascript:document.editForm.formchange.value='SOUND,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete this sound')"><tmpl_if use_texticon>gettext('delete this sound')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete this sound')"></tmpl_if></a>&nbsp;&nbsp;
            <tmpl_if GROUP><input type="hidden" name="SOUND.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">"></tmpl_if>
            <input type="hidden" name="SOUND.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">">
            <tmpl_loop TYPES>
            <input type="hidden" name="SOUND.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            </tmpl_loop>
          </td>
        </tr>
        <tmpl_loop FN>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="FN.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="FN.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='FN,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">&nbsp;</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="FN.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if NICKNAME>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('Nicknames')</b>&nbsp;<a href="javascript:document.editForm.formchange.value='NICKNAME,0,1'; document.editForm.submit();" title="gettext('add another nickname')">+</a></td>
        </tr>
        <tmpl_loop NICKNAME>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="NICKNAME.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td>
            <input class="mono" type="text" name="NICKNAME.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='NICKNAME,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if>
            <tmpl_loop TYPES>
            <input type="hidden" name="NICKNAME.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
          </td>
        </tr>
        <tmpl_if last>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">&nbsp;</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">&nbsp;</td>
        </tr>
        </tmpl_if>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if SORT-STRING>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('Last Name Sort Override')</b></td>
        </tr>
        <tmpl_loop SORT-STRING>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="SORT-STRING.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="SORT-STRING.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='SORT-STRING,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('last name:<i>von Trapp</i>&nbsp;&nbsp;&nbsp;sort override:<i>Trapp</i>')</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="SORT-STRING.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if X-OWM-BDAY>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="5"><b>gettext('Birthday')</b></td>
        </tr>
        <tmpl_loop X-OWM-BDAY>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="X-OWM-BDAY.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="X-OWM-BDAY.<tmpl_var count escape="html">.VALUE.MONTH" value="<tmpl_var MONTH escape="html">" size="3" maxlength="2" onblur="updateX_OWM_BDAY_AGE(this);">&nbsp;&nbsp;</td>
          <td><input class="mono" type="text" name="X-OWM-BDAY.<tmpl_var count escape="html">.VALUE.DAY" value="<tmpl_var DAY escape="html">" size="3" maxlength="2" onblur="updateX_OWM_BDAY_AGE(this);">&nbsp;&nbsp;</td>
          <td><input class="mono" type="text" name="X-OWM-BDAY.<tmpl_var count escape="html">.VALUE.YEAR" value="<tmpl_var YEAR escape="html">" size="5" maxlength="4" onblur="updateX_OWM_BDAY_AGE(this);">&nbsp;&nbsp;</td>
          <td>
            <input class="mono" type="text" name="X-OWM-BDAY.<tmpl_var count escape="html">.VALUE.AGE" value="<tmpl_var AGE escape="html">" size="4" maxlength="4" onfocus="updateX_OWM_BDAY_AGE(this);" onblur="updateX_OWM_BDAY_YEAR(this);">
            <a href="javascript:void(0);" onclick="calPopup(this,document.editForm.elements['X-OWM-BDAY.<tmpl_var count escape="js">.VALUE.YEAR'].value,document.editForm.elements['X-OWM-BDAY.<tmpl_var count escape="js">.VALUE.MONTH'].value,document.editForm.elements['X-OWM-BDAY.<tmpl_var count escape="js">.VALUE.DAY'].value,'updateX_OWM_BDAY','popup_calendar',50,0);" title="gettext('calendar')"><tmpl_if use_texticon>gettext('calendar')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_calendar escape="html">" class="iconset_small" alt="gettext('calendar')"></tmpl_if></a>&nbsp;
            <tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='X-OWM-BDAY,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if>
          </td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('month')</td>
          <td class="smalltext">gettext('day')</td>
          <td class="smalltext">gettext('year')</td>
          <td class="smalltext">gettext('age')</td>
        </tr>
        <tr>
          <td colspan="5" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="X-OWM-BDAY.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>
    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td class="columnheader">gettext('Email Addresses')&nbsp;<a name="EMAIL" href="javascript:document.editForm.formchange.value='EMAIL,0,1'; document.editForm.submit();" title="gettext('add another email address')">+</a></td>
</tr>
<tr>
  <td class="windowdark">
    <table cellpadding="0" cellspacing="0" border="0" width="95%" align="center">
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tmpl_if EMAIL>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tmpl_loop EMAIL>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="EMAIL.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td>
            <input class="mono" type="text" name="EMAIL.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">
            <input type="radio" name="EMAIL.preferred" value="<tmpl_var count escape="html">" <tmpl_if PREF>checked="checked"</tmpl_if>>
            &nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='EMAIL,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if>
          </td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="EMAIL.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      <td>
    <tr>
    </tmpl_if>
    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td class="columnheader">gettext('Telephone Numbers')&nbsp;<a name="TEL" href="javascript:document.editForm.formchange.value='TEL,0,1'; document.editForm.submit();" title="gettext('add another telephone number')">+</a></td>
</tr>
<tr>
  <td class="windowdark">
    <table cellpadding="0" cellspacing="0" border="0" width="95%" align="center">
    <tr>
      <td>&nbsp;</td>
    </tr>

    <tmpl_if TEL>
    <tr>
      <td nowrap>
        <table cellpadding="0" cellspacing="0" border="0">

        <tmpl_loop TEL>
        <tr>
          <td nowrap><tmpl_if GROUP><input class="mono" type="text" name="EMAIL.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if><input class="mono" type="text" name="TEL.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="25"><input type="radio" name="TEL.preferred" value="<tmpl_var count escape="html">" <tmpl_if PREF>checked="checked"</tmpl_if>></td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="HOME" <tmpl_if HOME>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','HOME');"><span class="smalltext">gettext('home')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="WORK" <tmpl_if WORK>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','WORK');"><span class="smalltext">gettext('work')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="CELL" <tmpl_if CELL>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','CELL');"><span class="smalltext">gettext('cell')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="CAR" <tmpl_if CAR>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','CAR');"><span class="smalltext">gettext('car')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="VIDEO" <tmpl_if VIDEO>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','VIDEO');"><span class="smalltext">gettext('video')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="PAGER" <tmpl_if PAGER>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','PAGER');"><span class="smalltext">gettext('pager')</span></a>&nbsp;</td>
          <td rowspan="2" nowrap>&nbsp;&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='TEL,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="VOICE" <tmpl_if VOICE>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','VOICE');"><span class="smalltext">gettext('voice')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="FAX" <tmpl_if FAX>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','FAX');"><span class="smalltext">gettext('fax')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="ISDN" <tmpl_if ISDN>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','ISDN');"><span class="smalltext">gettext('isdn')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="BBS" <tmpl_if BBS>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','BBS');"><span class="smalltext">gettext('bbs')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="MODEM" <tmpl_if MODEM>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','MODEM');"><span class="smalltext">gettext('modem')</span></a>&nbsp;</td>
          <td><input class="mono" type="checkbox" name="TEL.<tmpl_var count escape="html">.TYPE" value="MSG" <tmpl_if MSG>checked="checked"</tmpl_if>></td>
          <td nowrap>&nbsp;<a href="javascript:toggle_checkbox('TEL.<tmpl_var count escape="html">.TYPE','MSG');"><span class="smalltext">gettext('message')</span></a>&nbsp;</td>
        </tr>
        <tr>
          <td colspan="16">&nbsp;</td>
        </tr>
        </tmpl_loop>

        </table>
      </td>
    </tr>
    </tmpl_if>

    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td class="columnheader">gettext('Addresses')&nbsp;<a name="ADR" href="javascript:document.editForm.formchange.value='ADR,0,1'; document.editForm.submit();" title="gettext('add another address')">+</a></td>
</tr>
<tr>
  <td class="windowdark">
    <table cellpadding="0" cellspacing="0" border="0" width="95%" align="center">
    <tr>
      <td>&nbsp;</td>
    </tr>

    <tmpl_if ADR>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">

        <tmpl_loop ADR>
        <tr>
          <td valign="top" rowspan="3">
            <table cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td rowspan="12" valign="top">
                <tmpl_if GROUP>
                <table cellpadding="0" cellspacing="0" border="0">
                <tr>
                  <td nowrap><input class="mono" type="text" name="ADR.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;</td>
                </tr>
                <tr>
                  <td class="smalltext">gettext('group')</td>
                </tr>
                </table>
                <tmpl_else>
                &nbsp;
                </tmpl_if>
              </td>
              <td><input class="mono" type="text" name="ADR.<tmpl_var count escape="html">.VALUE.STREET" value="<tmpl_var STREET escape="html">" size="27"></td>
            </tr>
            <tr>
              <td class="smalltext">gettext('street address')</td>
            </tr>
            <tr>
              <td class="smalltext">&nbsp;</td>
            </tr>
            <tr>
              <td><input class="mono" type="text" name="ADR.<tmpl_var count escape="html">.VALUE.EXTENDEDADDRESS" value="<tmpl_var EXTENDEDADDRESS escape="html">" size="27"></td>
            </tr>
            <tr>
              <td class="smalltext">gettext('suite, apartment, etc.')</td>
            </tr>
            <tr>
              <td class="smalltext">&nbsp;</td>
            </tr>
            <tr>
              <td><input class="mono" type="text" name="ADR.<tmpl_var count escape="html">.VALUE.POSTOFFICEADDRESS" value="<tmpl_var POSTOFFICEADDRESS escape="html">" size="27"></td>
            </tr>
            <tr>
              <td class="smalltext">gettext('postoffice box')</td>
            </tr>
            <tr>
              <td class="smalltext">&nbsp;</td>
            </tr>
            <tr>
              <td align="right">
                <table cellpadding="0" cellspacing="0" border="0">
                <tr>
                  <td><input class="mono" type="text" name="ADR.<tmpl_var count escape="html">.VALUE.LOCALITY" value="<tmpl_var LOCALITY escape="html">" size="12"></td>
                  <td>&nbsp;</td>
                  <td><input class="mono" type="text" name="ADR.<tmpl_var count escape="html">.VALUE.REGION" value="<tmpl_var REGION escape="html">" size="11"></td>
                </tr>
                <tr>
                  <td class="smalltext">gettext('city')</td>
                  <td>&nbsp;</td>
                  <td class="smalltext">gettext('state/province')</td>
                </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td class="smalltext">&nbsp;</td>
            </tr>
            <tr>
              <td align="right">
                <table cellpadding="0" cellspacing="0" border="0">
                <tr>
                  <td><input class="mono" type="text" name="ADR.<tmpl_var count escape="html">.VALUE.POSTALCODE" value="<tmpl_var POSTALCODE escape="html">" size="10"></td>
                  <td>&nbsp;</td>
                  <td><input class="mono" type="text" name="ADR.<tmpl_var count escape="html">.VALUE.COUNTRY" value="<tmpl_var COUNTRY escape="html">" size="10" onblur="if (document.forms['editForm'].elements['ADR.<tmpl_var count escape="html">.VALUE.LABEL'].value == '') { make_label('<tmpl_var count escape="js">'); update_map('<tmpl_var count escape="js">'); }"></td>
                </tr>
                <tr>
                  <td class="smalltext">gettext('zip/postcode')</td>
                  <td>&nbsp;</td>
                  <td class="smalltext">gettext('country')</td>
                </tr>
                </table>
              </td>
            </tr>
            </table>
          </td>
          <td width="15" rowspan="3">&nbsp;</td>
          <td valign="top" <tmpl_unless enable_map>height="50%"</tmpl_unless>>
            <table cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td><input class="mono" type="checkbox" name="ADR.<tmpl_var count escape="html">.TYPE" value="HOME" <tmpl_if HOME>checked="checked"</tmpl_if>></td>
              <td rowspan="6" width="5">&nbsp;</td>
              <td nowrap><a href="javascript:toggle_checkbox('ADR.<tmpl_var count escape="html">.TYPE','HOME');"><span class="smalltext">gettext('home address')</span></a></td>
            </tr>
            <tr>
              <td><input class="mono" type="checkbox" name="ADR.<tmpl_var count escape="html">.TYPE" value="WORK" <tmpl_if WORK>checked="checked"</tmpl_if>></td>
              <td nowrap><a href="javascript:toggle_checkbox('ADR.<tmpl_var count escape="html">.TYPE','WORK');"><span class="smalltext">gettext('work address')</span></a></td>
            </tr>
            <tr>
              <td><input class="mono" type="checkbox" name="ADR.<tmpl_var count escape="html">.TYPE" value="DOM" <tmpl_if DOM>checked="checked"</tmpl_if>></td>
              <td nowrap><a href="javascript:toggle_checkbox('ADR.<tmpl_var count escape="html">.TYPE','DOM');"><span class="smalltext">gettext('domestic address')</span></a></td>
            </tr>
            <tr>
              <td><input class="mono" type="checkbox" name="ADR.<tmpl_var count escape="html">.TYPE" value="INTL" <tmpl_if INTL>checked="checked"</tmpl_if>></td>
              <td nowrap><a href="javascript:toggle_checkbox('ADR.<tmpl_var count escape="html">.TYPE','INTL');"><span class="smalltext">gettext('international address')</span></a></td>
            </tr>
            <tr>
              <td><input class="mono" type="checkbox" name="ADR.<tmpl_var count escape="html">.TYPE" value="POSTAL" <tmpl_if POSTAL>checked="checked"</tmpl_if>></td>
              <td nowrap><a href="javascript:toggle_checkbox('ADR.<tmpl_var count escape="html">.TYPE','POSTAL');"><span class="smalltext">gettext('postal address')</span></a></td>
            </tr>
            <tr>
              <td><input class="mono" type="checkbox" name="ADR.<tmpl_var count escape="html">.TYPE" value="PARCEL" <tmpl_if PARCEL>checked="checked"</tmpl_if>></td>
              <td nowrap><a href="javascript:toggle_checkbox('ADR.<tmpl_var count escape="html">.TYPE','PARCEL');"><span class="smalltext">gettext('parcel delivery address')</span></a></td>
            </tr>
            </table>
          </td>
          <td width="15">&nbsp;</td>
          <td valign="top"><textarea rows="6" cols="25" wrap="hard" name="ADR.<tmpl_var count escape="html">.VALUE.LABEL"><tmpl_var LABEL escape="html"></textarea></td>
          <td width="15" valign="top"><input type="radio" name="ADR.preferred" value="<tmpl_var count escape="html">" <tmpl_if PREF>checked="checked"</tmpl_if>></td>
        </tr>
        <tmpl_if enable_map>
        <tr>
          <td colspan="3" align="center">
            <iframe name="map_<tmpl_var count escape="html">" class="map" width="370" height="100" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.com/maps?q=<tmpl_var mapquery escape="url">&amp;iwloc=near&amp;output=embed"></iframe>
          </td>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td colspan="3" valign="top" align="center" class="rowdark">
            <a href="javascript:make_label('<tmpl_var count escape="js">');"><span class="smalltext"><b>gettext('make label')</b></span></a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="javascript:void(0);" onclick="update_map('<tmpl_var count escape="js">');"><span class="smalltext"><b>gettext('update map')</b></span></a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="http://maps.google.com/maps?q=<tmpl_var mapquery escape="url">" target="_new" name="viewlarger_<tmpl_var count escape="html">"><span class="smalltext"><b>gettext('view larger')</b></span></a>
          </td>
          <td width="15" valign="top" align="center"><tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='ADR,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if>&nbsp;</td>
        </tr>
        <tmpl_else>
        <tr>
          <td colspan="3" align="right"><a href="javascript:make_label('<tmpl_var count escape="js">');"><span class="smalltext"><b>gettext('make label')</b></span></a></td>
          <td width="15" height="10%" valign="top" align="center">&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='ADR,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr><td colspan="4">&nbsp;</td></tr>
        </tmpl_if>
        <tr><td colspan="6">&nbsp;<br>&nbsp;</td></tr>
        </tmpl_loop>

        </table>
      </td>
    </tr>
    </tmpl_if>
    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td class="columnheader">gettext('Work Information')&nbsp;<a name="ORG" href="javascript:document.editForm.formchange.value='ORG,0,1'; document.editForm.submit();" title="gettext('add another set of work information')">+</a></td>
</tr>
<tr>
  <td class="windowdark">
    <table cellpadding="0" cellspacing="0" border="0" width="95%" align="center">
    <tr>
      <td>&nbsp;</td>
    </tr>

    <tmpl_if LOGO>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tmpl_loop LOGO>
        <tr>
          <tmpl_if URI>
          <tmpl_if show_inline>
          <td><a name="LOGO" href="<tmpl_var VALUE escape="html">" target="_new"><img src="<tmpl_var VALUE escape="html">" border="1"></a></td>
          <tmpl_else>
          <td width="52" height="52" bgcolor="#000000" align="center">
            <table cellspacing="0" cellpadding="0" border="0">
            <tr>
              <td align="center" width="50" height="50" class="rowlight">
                <a name="LOGO" href="<tmpl_var VALUE escape="html">" target="_new" class="icon" title="<tmpl_var VALUE escape="html">"><tmpl_if use_texticon><tmpl_var VALUE escape="html"><tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_link escape="html">" class="iconset_small" alt="<tmpl_var VALUE escape="html">"></tmpl_if></a>
              </td>
            </tr>
            </table>
          </td>
          </tmpl_if>
          <tmpl_else>
          <tmpl_if BASE64>
          <td>
            <a name="LOGO" href="<tmpl_var url_cgi escape="html">/openwebmail-abook.pl?action=addrviewatt&amp;sessionid=<tmpl_var sessionid escape="html">&amp;file=<tmpl_var VALUE escape="html">&amp;type=<tmpl_var filetype escape="html">" target="_new"><img src="<tmpl_var url_cgi escape="html">/openwebmail-abook.pl?action=addrviewatt&amp;sessionid=<tmpl_var sessionid escape="html">&amp;file=<tmpl_var VALUE escape="html">&amp;type=<tmpl_var filetype escape="html">" border="1"></a>
          </td>
          <tmpl_else>
          <td>gettext('Logo could not be displayed')</td>
          </tmpl_if>
          </tmpl_if>
          <td valign="bottom">
             &nbsp;&nbsp;<a href="javascript:document.editForm.formchange.value='LOGO,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a>
             <input type="hidden" name="LOGO.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">">
             <tmpl_loop TYPES>
             <input type="hidden" name="LOGO.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
             </tmpl_loop>
             <tmpl_if GROUP><input type="hidden" name="LOGO.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">"></tmpl_if>
          </td>
        </tr>
        <tr>
          <td colspan="2">&nbsp;</td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if ORG>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">

        <tmpl_loop ORG>
        <tr>
          <td>&nbsp;</td>
          <td><b>gettext('Company Name')</b></td>
          <td rowspan="3">&nbsp;</td>
          <td><b>gettext('Job Title')</b></td>
        </tr>
        <tr>
          <td>&nbsp;<tmpl_if GROUP><input class="mono" type="text" name="ORG.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="ORG.<tmpl_var count escape="html">.VALUE.ORGANIZATIONNAME" value="<tmpl_var ORGANIZATIONNAME escape="html">" size="30"></td>
          <td><input class="mono" type="text" name="ORG.<tmpl_var count escape="html">.VALUE.TITLE" value="<tmpl_var TITLE escape="html">" size="30">&nbsp;&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='ORG,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete this entire work grouping')"><tmpl_if use_texticon>gettext('delete this entire work grouping')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete this entire work grouping')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td rowspan="5" class="smalltext" valign="top"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('abc, inc.')</td>
          <td class="smalltext">gettext('v.p., research and development')</td>
        </tr>
        <tr>
          <td colspan="3" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="ORG.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        <tr>
          <td><b>gettext('Job Classification')</b></td>
          <td rowspan="2">&nbsp;</td>
          <td><b>gettext('Division Structure')</b>&nbsp;<a href="javascript:document.editForm.formchange.value='ORG.<tmpl_var count escape="html">.VALUE.ORGANIZATIONALUNITS,0,1'; document.editForm.submit();" title="gettext('add another division')">+</a></td>
        </tr>
        <tr>
          <td valign="top">
            <table cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td><input class="mono" type="text" name="ORG.<tmpl_var count escape="html">.VALUE.ROLE" value="<tmpl_var ROLE escape="html">" size="30"></td>
            </tr>
            <tr>
              <td class="smalltext">gettext('manager, executive, etc')</td>
            </tr>
            </table>
          </td>
          <td valign="top">
            <table cellpadding="0" cellspacing="0" border="0">
            <tmpl_loop ORGANIZATIONALUNITS>
            <tr>
              <td><input class="mono" type="text" name="ORG.<tmpl_var count escape="html">.VALUE.ORGANIZATIONALUNITS.<tmpl_var unitcount escape="html">" value="<tmpl_var unit escape="html">" size="30">&nbsp;&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='ORG.<tmpl_var count escape="html">.VALUE.ORGANIZATIONALUNITS,<tmpl_var unitcount escape="js">,-1'; document.editForm.submit();" title="gettext('delete this division')"><tmpl_if use_texticon>gettext('delete this division')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete this division')"></tmpl_if></a></tmpl_if></td>
            </tr>
            <tmpl_if last>
            <tr>
              <td class="smalltext">gettext('accounting, european division')</td>
            </tr>
            </tmpl_if>
            </tmpl_loop>
            </table>
          </td>
        </tr>
        <tr>
          <td colspan="3" height="40">&nbsp;</td>
        </tr>
        </tmpl_loop>

        </table>
      </td>
    </tr>
    </tmpl_if>

    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td class="columnheader">gettext('Miscellaneous Information')<a name="URL"></a></td>
</tr>
<tr>
  <td class="windowdark">
    <table cellpadding="0" cellspacing="0" border="0" width="95%" align="center">
    <tr>
      <td>&nbsp;</td>
    </tr>

    <tmpl_if URL>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('Websites')</b>&nbsp;<a href="javascript:document.editForm.formchange.value='URL,0,1'; document.editForm.submit();" title="gettext('add another website')">+</a></td>
        </tr>

        <tmpl_loop URL>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="URL.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td>
            <input class="mono" type="text" name="URL.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='URL,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if>
            <tmpl_loop TYPES>
            <input type="hidden" name="URL.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
          </td>
        </tr>
        <tmpl_if last>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('http://www.example.com')</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">&nbsp;</td>
        </tr>
        </tmpl_if>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if TZ>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('Timezone')</b></td>
        </tr>
        <tmpl_loop TZ>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="TZ.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td>
            <select class="mono" name="TZ.<tmpl_var count escape="html">.VALUE">
            <tmpl_loop tzselectloop>
              <option value="<tmpl_var option escape="html">" <tmpl_if selected>selected</tmpl_if>><tmpl_var label escape="html"></option>
            </tmpl_loop>
            </select>
            &nbsp;
            <a href="<tmpl_var url_html escape="none">/images/system/timezone.gif" target="_timezonemap" title="gettext('timezone map')"><tmpl_if use_texticon>gettext('timezone map')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_earthtimezone escape="html">" class="iconset_small" alt="gettext('timezone map')"></tmpl_if></a>
            &nbsp;
            <tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='TZ,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if>
            <tmpl_loop TYPES>
            <input type="hidden" name="TZ.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
          </td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">&nbsp;</td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if GEO>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="7"><b>gettext('Geographic Position')</b></td>
        </tr>
        <tmpl_loop GEO>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="GEO.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="GEO.<tmpl_var count escape="html">.VALUE.LATITUDE" value="<tmpl_var LATITUDE escape="html">" size="20">&nbsp;&nbsp;</td>
          <td><input class="mono" type="text" name="GEO.<tmpl_var count escape="html">.VALUE.LONGITUDE" value="<tmpl_var LONGITUDE escape="html">" size="20">&nbsp;&nbsp;</td>
          <td><a href="http://itouchmap.com/latlong.html" target="_new" title="gettext('find your geographic position')"><tmpl_if use_texticon>gettext('find your geographic position')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_search escape="html">" class="iconset_small" alt="gettext('find your geographic position')"></tmpl_if></a>&nbsp;&nbsp;</td>
          <td><a href="javascript:showGeo('<tmpl_var count escape="html">','map');" title="gettext('show a map of this location')"><tmpl_if use_texticon>gettext('show a map of this location')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_earth escape="html">" class="iconset_small" alt="gettext('show a map of this location')"></tmpl_if></a>&nbsp;&nbsp;</td>
          <td><a href="javascript:showGeo('<tmpl_var count escape="html">','photo');" title="gettext('show a satellite photo of this location')"><tmpl_if use_texticon>gettext('show a satellite photo of this location')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_camera escape="html">" class="iconset_small" alt="gettext('show a satellite photo of this location')"></tmpl_if></a>&nbsp;&nbsp;</td>
          <td><tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='GEO,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('latitude')&nbsp;&nbsp;(32.550266)</td>
          <td class="smalltext">gettext('longitude')&nbsp;&nbsp;(-120.209183)</td>
          <td class="smalltext" colspan="4">&nbsp;</td>
        </tr>
        <tr>
          <td colspan="7" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="GEO.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if MAILER>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('Email Program')</b></td>
        </tr>
        <tmpl_loop MAILER>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="MAILER.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="MAILER.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='MAILER,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('openwebmail, outlook, etc')</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="MAILER.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if NOTE>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="3"><b>gettext('Note')</b></td>
        </tr>
        <tmpl_loop NOTE>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="NOTE.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><textarea class="mono" cols="60" rows="8" name="NOTE.<tmpl_var count escape="html">.VALUE"><tmpl_var VALUE escape="html"></textarea></td>
          <td>
            &nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='NOTE,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if>
            <tmpl_loop TYPES>
            <input type="hidden" name="NOTE.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
          </td>
        </tr>
        <tr>
          <td class="smalltext" valign="top"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext" colspan="2">&nbsp;</td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if KEY>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0" width="50%">
        <tr>
          <td class="windowdark"><b>gettext('Privacy Keys')</b><a name="KEY"></a></td>
        </tr>
        <tr>
          <td bgcolor="#000000">
            <table cellpadding="2" cellspacing="1" border="0" width="100%">
            <tmpl_loop KEY>
            <tr>
              <td class="<tmpl_if even>rowlight<tmpl_else>rowdark</tmpl_if>">
                &nbsp;
                <tmpl_if VALUE>
                <tmpl_if URI>
                <a href="<tmpl_var VALUE escape="html">" target="_new" title="gettext('download this privacy key')"><tmpl_if use_texticon>gettext('download this privacy key')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_padlock escape="html">" class="iconset_small" alt="gettext('download this privacy key')"></tmpl_if>
                <tmpl_else>
                <a href="<tmpl_var url_cgi escape="html">/openwebmail-abook.pl?action=addrviewatt&amp;sessionid=<tmpl_var sessionid escape="html">&amp;file=<tmpl_var VALUE escape="html">&amp;type=<tmpl_var filetype escape="html">" target="_new" title="gettext('download this privacy key')"><tmpl_if use_texticon>gettext('download this privacy key')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_padlock escape="html">" class="iconset_small" alt="gettext('download this privacy key')"></tmpl_if>
                </tmpl_if>
                &nbsp;&nbsp;<tmpl_if GPG>gettext('GNU GPG Privacy Guard Key')</tmpl_if><tmpl_if PGP>gettext('IETF PGP Pretty Good Privacy Key')</tmpl_if><tmpl_if X509>gettext('X.509 Public Key Certificate')</tmpl_if><tmpl_if unknown_type>gettext('unknown key type')</tmpl_if>
                </a>
                &nbsp;
                <a href="javascript:document.editForm.formchange.value='KEY,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a>
                <tmpl_if GROUP><input type="hidden" name="KEY.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">"></tmpl_if>
                <input type="hidden" name="KEY.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">">
                <tmpl_loop TYPES>
                <input type="hidden" name="KEY.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
                </tmpl_loop>
                <tmpl_else>
                gettext('no keys exist for this contact')
                </tmpl_if>
              </td>
            </tr>
            </tmpl_loop>
            </table>
          </td>
        </tr>
        <tr>
          <td>&nbsp;</td>
        </tr>
        </table>
      <td>
    <tr>
    </tmpl_if>

    <tmpl_if AGENT>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0" width="50%">
        <tr>
          <td class="windowdark">
            <table cellpadding="0" cellspacing="0" border="0" width="100%">
            <tr>
              <td><b>gettext('Agents')</b><a name="AGENT"></a></td>
              <td align="right">
              <tmpl_if is_abookfolder_writable>
              <a href="javascript:document.editForm.targetagent.value='1<tmpl_if has_targetagent>,<tmpl_var targetagentpath escape="html"></tmpl_if>,<tmpl_var totalagents escape="html">'; document.editForm.submit();" onClick="return (confirm_agent_action('save') && savecheck());">gettext('add new agent')</a>
              <tmpl_else>
              &nbsp;
              </tmpl_if>
              </td>
            </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td bgcolor="#000000">
            <table cellpadding="2" cellspacing="1" border="0" width="100%">
            <tmpl_loop AGENT>
            <tr>
              <td class="<tmpl_if even>rowlight<tmpl_else>rowdark</tmpl_if>">
                &nbsp;
                <tmpl_if VALUE>
                <tmpl_if URI>
                <a href="<tmpl_var VALUE escape="html">" target="_new" title="gettext('download this agent')"><tmpl_if use_texticon>gettext('download this agent')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_vcard escape="html">" class="iconset_small" alt="gettext('download this agent')"></tmpl_if>&nbsp;&nbsp;<tmpl_if VCARD>gettext('Versit Card (vCard)')</tmpl_if><tmpl_if unknown_type>gettext('unknown agent type')</tmpl_if></a>
                <tmpl_else>
                  <tmpl_if VCARD>
                  <a href="<tmpl_var url_cgi escape="html">/openwebmail-abook.pl?action=addrviewatt&amp;sessionid=<tmpl_var sessionid escape="html">&amp;file=<tmpl_var VALUE escape="html">&amp;type=<tmpl_var filetype escape="html">" target="_new" title="gettext('download this agent')"><tmpl_if use_texticon>gettext('download this agent')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_vcard escape="html">" class="iconset_small" alt="gettext('download this agent')"></tmpl_if></a>
                  <tmpl_if is_abookfolder_writable>
                  &nbsp;&nbsp;<a href="javascript:document.editForm.targetagent.value='1<tmpl_if has_targetagent>,<tmpl_var targetagentpath escape="html"></tmpl_if>,<tmpl_var count escape="html">'; document.editForm.submit();" onClick="return (confirm_agent_action('save') && savecheck());"><tmpl_var agentname escape="html"></a>
                  <tmpl_else>
                  &nbsp;&nbsp;<tmpl_var agentname escape="html">
                  </tmpl_if>
                  <tmpl_else>
                  <a href="<tmpl_var url_cgi escape="html">/openwebmail-abook.pl?action=addrviewatt&amp;sessionid=<tmpl_var sessionid escape="html">&amp;file=<tmpl_var VALUE escape="html">&amp;type=<tmpl_var filetype escape="html">" target="_new" title="gettext('download this agent')"><tmpl_if use_texticon>gettext('download this agent')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_vcard escape="html">" class="iconset_small" alt="gettext('download this agent')"></tmpl_if>&nbsp;&nbsp;<tmpl_if VCARD>gettext('Versit Card (vCard)')</tmpl_if><tmpl_if unknown_type>gettext('unknown agent type')</tmpl_if></a>
                  </tmpl_if>
                </tmpl_if>
                &nbsp;
                <a href="javascript:document.editForm.formchange.value='AGENT,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a>
                <tmpl_if GROUP><input type="hidden" name="AGENT.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">"></tmpl_if>
                <input type="hidden" name="AGENT.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">">
                <tmpl_loop TYPES>
                <input type="hidden" name="AGENT.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
                </tmpl_loop>
                <tmpl_else>
                gettext('no one acts on behalf of this contact')
                </tmpl_if>
              </td>
            </tr>
            </tmpl_loop>
            </table>
          </td>
        </tr>
        <tr>
          <td>&nbsp;</td>
        </tr>
        </table>
      <td>
    <tr>
    </tmpl_if>

    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td class="columnheader">gettext('vCard Information')</td>
</tr>
<tr>
  <td class="windowdark">
    <table cellpadding="0" cellspacing="0" border="0" width="95%" align="center">
    <tr>
      <td>&nbsp;</td>
    </tr>

    <tmpl_if CLASS>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('Access Classification')</b></td>
        </tr>
        <tmpl_loop CLASS>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="CLASS.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td>
            <select class="mono" name="CLASS.<tmpl_var count escape="html">.VALUE">
            <tmpl_loop classselectloop>
              <tmpl_if option_PUBLIC><option value="PUBLIC" <tmpl_if selected>selected</tmpl_if>>gettext('Public')</option></tmpl_if>
              <tmpl_if option_PRIVATE><option value="PRIVATE" <tmpl_if selected>selected</tmpl_if>>gettext('Private')</option></tmpl_if>
              <tmpl_if option_OTHER><option value="<tmpl_var option_OTHER escape="html">" selected><tmpl_var option_OTHER escape="html"></option></tmpl_if>
            </tmpl_loop>
            </select>
            &nbsp;
            <tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='CLASS,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if>
            <tmpl_loop TYPES>
            <input type="hidden" name="CLASS.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
          </td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">&nbsp;</td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if SOURCE>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('vCard Source URL')</b></td>
        </tr>
        <tmpl_loop SOURCE>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="SOURCE.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="SOURCE.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='SOURCE,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('http://www.example.com/mycard.vcf')</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="SOURCE.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if NAME>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('vCard Source Name')</b></td>
        </tr>
        <tmpl_loop NAME>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="NAME.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="NAME.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='NAME,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('a description of the source url')</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="NAME.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if UID>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('External Unique ID')</b></td>
        </tr>
        <tmpl_loop UID>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="UID.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="UID.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='UID,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('used by external programs to identify this card')</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="UID.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if PRODID>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td colspan="2"><b>gettext('Creator Program')</b></td>
        </tr>
        <tmpl_loop PRODID>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="PRODID.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="PRODID.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='PRODID,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">gettext('outlook, openwebmail, etc')</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="PRODID.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td class="columnheader">gettext('Custom Properties')&nbsp;<a name="X-OWM-CUSTOM" href="javascript:document.editForm.formchange.value='X-OWM-CUSTOM,0,1'; document.editForm.submit();" title="gettext('add another custom property')">+</a></td>
</tr>
<tr>
  <td class="windowdark">
    <table cellpadding="0" cellspacing="0" border="0" width="95%" align="center">
    <tr>
      <td>&nbsp;</td>
    </tr>

    <tmpl_if X-OWM-CUSTOM>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tmpl_loop X-OWM-CUSTOM>
        <tr>
          <td><b>gettext('Custom Name')</b></td>
          <td rowspan="2">&nbsp;</td>
          <td><b>gettext('Custom Values')</b>&nbsp;<a href="javascript:document.editForm.formchange.value='X-OWM-CUSTOM.<tmpl_var count escape="html">.VALUE.CUSTOMVALUES,0,1'; document.editForm.submit();" title="gettext('add another custom value')">+</a></td>
        </tr>
        <tr>
          <td valign="top">
            <table cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td><tmpl_if GROUP><input class="mono" type="text" name="X-OWM-CUSTOM.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
              <td><input class="mono" type="text" name="X-OWM-CUSTOM.<tmpl_var count escape="html">.VALUE.CUSTOMNAME" value="<tmpl_var CUSTOMNAME escape="html">" size="30">&nbsp;&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='X-OWM-CUSTOM,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
            </tr>
            <tr>
              <td class="smalltext" valign="top"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
              <td class="smalltext">gettext('a custom name')</td>
            </tr>
            </table>
          </td>
          <td>
            <table cellpadding="0" cellspacing="0" border="0">
            <tmpl_loop CUSTOMVALUES>
            <tr>
              <td><input class="mono" type="text" name="X-OWM-CUSTOM.<tmpl_var count escape="html">.VALUE.CUSTOMVALUES.<tmpl_var valuescount escape="html">" value="<tmpl_var value escape="html">" size="30">&nbsp;&nbsp;<tmpl_if deleteable><a href="javascript:document.editForm.formchange.value='X-OWM-CUSTOM.<tmpl_var count escape="html">.VALUE.CUSTOMVALUES,<tmpl_var valuescount escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></tmpl_if></td>
            </tr>
            <tmpl_if last>
            <tr>
              <td class="smalltext">gettext('custom values')</td>
            </tr>
            </tmpl_if>
            </tmpl_loop>
            </table>
          </td>
        </tr>
        <tr>
          <td colspan="3" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="X-OWM-CUSTOM.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    <tmpl_if UNSUPPORTED>
    <tr>
      <td>
        <table cellpadding="0" cellspacing="0" border="0">
        <tmpl_loop UNSUPPORTED>
        <tr>
          <td colspan="2"><b><tmpl_var propertyname escape="html"></b></td>
        </tr>
        <tr>
          <td><tmpl_if GROUP><input class="mono" type="text" name="<tmpl_var propertyname escape="html">.<tmpl_var count escape="html">.GROUP" value="<tmpl_var GROUP escape="html">" size="12">&nbsp;&nbsp;<tmpl_else>&nbsp;</tmpl_if></td>
          <td><input class="mono" type="text" name="<tmpl_var propertyname escape="html">.<tmpl_var count escape="html">.VALUE" value="<tmpl_var VALUE escape="html">" size="35">&nbsp;<a href="javascript:document.editForm.formchange.value='<tmpl_var propertyname escape="html">,<tmpl_var count escape="js">,-1'; document.editForm.submit();" title="gettext('delete')"><tmpl_if use_texticon>gettext('delete')<tmpl_else><img src="<tmpl_var url_html escape="none">/images/iconsets/<tmpl_var iconset escape="html">/<tmpl_var iconset_small_trash escape="html">" class="iconset_small" alt="gettext('delete')"></tmpl_if></a></td>
        </tr>
        <tr>
          <td class="smalltext"><tmpl_if GROUP>gettext('group')<tmpl_else>&nbsp;</tmpl_if></td>
          <td class="smalltext">&nbsp;</td>
        </tr>
        <tr>
          <td colspan="2" class="smalltext">
            <tmpl_loop TYPES>
            <input type="hidden" name="<tmpl_var propertyname escape="html">.<tmpl_var count escape="html">.TYPE" value="<tmpl_var type escape="html">">
            </tmpl_loop>
            &nbsp;
          </td>
        </tr>
        </tmpl_loop>
        </table>
      </td>
    </tr>
    </tmpl_if>

    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td class="columnheader">gettext('Add Files to This Contact') - gettext('<tmpl_var availableattspace escape="html"> KB Available')</td>
</tr>
<tr>
  <td class="windowdark">
    <table cellpadding="0" cellspacing="0" border="0" width="75%" align="center">
    <tr>
      <td  colspan="9">&nbsp;</td>
    </tr>
    <tr>
      <td>
        <select name="UPLOAD.TYPE" class="mono">
          <option value="PHOTO" selected>gettext('Contact Photo (jpg,gif,png)')</option>
          <option value="SOUND">gettext('Full Name Pronunciation Sound (aif,wav)')</option>
          <option value="LOGO">gettext('Company Logo (jpg,gif,png)')</option>
          <option value="KEY">gettext('Public Encryption Key (gpg,pgp)')</option>
          <option value="AGENT">gettext('Agent vCard (vcf)')</option>
        </select>
      </td>
      <td width="5">&nbsp;</td>
      <td><input class="mono" type="text" name="UPLOAD.URI" value="" size="25"></td>
      <td width="5">&nbsp;</td>
      <td><input class="mono" type="file" name="UPLOAD.FILE" size="25"></td>
      <td width="5">&nbsp;</td>
      <td><input type="submit" name="upload" value="gettext('Add')"></td>
      <td width="5">&nbsp;</td>
      <td><!--future home of the upload via webdisk link-->&nbsp;</td>
    </tr>
    <tr>
      <td colspan="2" class="smalltext" nowrap>gettext('choose a file type to add')</td>
      <td colspan="2" class="smalltext" nowrap>gettext('enter a url to the file (http://...)')</td>
      <td colspan="5" class="smalltext" nowrap>gettext('or upload the file directly')</td>
    </tr>
    <tr>
      <td  colspan="9">&nbsp;</td>
    </tr>
    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
<tr>
  <td align="center">
    <table cellpadding="0" cellspacing="0" border="0">
    <tr>
      <td>
        <tmpl_if targetdepth><input type="submit" name="saveparent" value="gettext('save and return to parent')" accesskey="S" onclick="document.editForm.targetagent.value='-1<tmpl_if has_targetagent>,<tmpl_var targetagentpath escape="html"></tmpl_if>'; return (confirm_agent_action('save') && savecheck());">&nbsp;&nbsp;</tmpl_if><tmpl_if can_save><input type="submit" name="save" value="gettext('save')" accesskey="S" onclick="return savecheck();">&nbsp;&nbsp;</tmpl_if><input type="button" name="cancel" value="gettext('cancel')" onclick="document.cancelform.submit();"><tmpl_if targetdepth>&nbsp;&nbsp;<input type="submit" name="cancelparent" value="gettext('cancel and return to parent')" accesskey="C" onclick="document.editForm.targetagent.value='-1<tmpl_if has_targetagent>,<tmpl_var targetagentpath escape="html"></tmpl_if>'; confirm_agent_action('cancel');"></tmpl_if>
      </td>
    </tr>
    </table>
  </td>
</tr>
<tr>
  <td>&nbsp;</td>
</tr>
</table>
</tmpl_loop>

</form>

<tmpl_if is_caller_listmessages>
<form action="<tmpl_var url_cgi escape="none">/openwebmail-main.pl" method="post" name="cancelform" id="cancelform">
<input type="hidden" name="action" value="listmessages">
</tmpl_if>

<tmpl_if is_caller_readmessage>
<form action="<tmpl_var url_cgi escape="none">/openwebmail-read.pl" method="post" name="cancelform" id="cancelform">
<input type="hidden" name="action" value="readmessage">
</tmpl_if>

<tmpl_if is_caller_ALL>
<form action="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl" method="post" name="cancelform" id="cancelform">
<input type="hidden" name="action" value="addrlistview">
</tmpl_if>

<tmpl_if is_caller_abookfolder>
<form action="<tmpl_var url_cgi escape="none">/openwebmail-abook.pl" method="post" name="cancelform" id="cancelform">
<input type="hidden" name="action" value="addrlistview">
</tmpl_if>

<input type="hidden" name="sessionid" value="<tmpl_var sessionid escape="html">">
<input type="hidden" name="folder" value="<tmpl_var folder escape="html">">
<input type="hidden" name="sort" value="<tmpl_var sort escape="html">">
<input type="hidden" name="page" value="<tmpl_var page escape="html">">
<input type="hidden" name="longpage" value="<tmpl_var longpage escape="html">">
<input type="hidden" name="searchtype" value="<tmpl_var searchtype escape="html">">
<input type="hidden" name="keyword" value="<tmpl_var keyword escape="html">">
<input type="hidden" name="msgdatetype" value="<tmpl_var msgdatetype escape="html">">
<input type="hidden" name="message_id" value="<tmpl_var messageid escape="html">">

<input type="hidden" name="abookfolder" value="<tmpl_if is_caller_ALL>ALL<tmpl_else><tmpl_var abookfolder escape="html"></tmpl_if>">
<input type="hidden" name="abooksort" value="<tmpl_var abooksort escape="html">">
<input type="hidden" name="abookpage" value="<tmpl_var abookpage escape="html">">
<input type="hidden" name="abooklongpage" value="<tmpl_var abooklongpage escape="html">">
<input type="hidden" name="abooksearchtype" value="<tmpl_var abooksearchtype escape="html">">
<input type="hidden" name="abookkeyword" value="<tmpl_var abookkeyword escape="html">">
<input type="hidden" name="abookcollapse" value="<tmpl_var abookcollapse escape="html">">
</form>

<div id="popup_calendar"></div>

<script type="text/javascript" src="<tmpl_var url_html escape="none">/javascript/popup_base.js"></script>
<script type="text/javascript" src="<tmpl_var url_html escape="none">/javascript/popup_calendar.js"></script>
<script type="text/javascript" src="<tmpl_var url_html escape="none">/javascript/<tmpl_var makelabel escape="html">.js"></script>

<script type="text/javascript">
<!--
// popup_calendar.js language and preferences
var wStart     = <tmpl_var weekstart escape="js">;
var wDay       = new Array('jgettext('Sunday')','jgettext('Monday')','jgettext('Tuesday')','jgettext('Wednesday')','jgettext('Thursday')','jgettext('Friday')','jgettext('Saturday')');
var wDayAbbrev = new Array(gettext(''S','M','T','W','T','F','S''));
var wMonth     = new Array('jgettext('January')','jgettext('February')','jgettext('March')','jgettext('April')','jgettext('May')','jgettext('June')','jgettext('July')','jgettext('August')','jgettext('September')','jgettext('October')','jgettext('November')','jgettext('December')');
var wOrder     = new Array('jgettext('1st')','jgettext('2nd')','jgettext('3rd')','jgettext('4th')','jgettext('last')');

function updateFN(caller) {
   // given a changed caller from the N property, update the FN property
   var caller_parts = caller.name.split('.');
   var i = caller_parts[1];

   // Chinese Japan Korean unicode regex
   var is_asian = /^[\u2e80-\u9fff\uac00-\ud7ff\uf900-\ufaff]/;

   // build the FN from the N properties
   var NAMEPREFIX      = document.editForm.elements['N.'+i+'.VALUE.NAMEPREFIX'].value;
   var GIVENNAME       = document.editForm.elements['N.'+i+'.VALUE.GIVENNAME'].value;
   var ADDITIONALNAMES = document.editForm.elements['N.'+i+'.VALUE.ADDITIONALNAMES'].value;
   var FAMILYNAME      = document.editForm.elements['N.'+i+'.VALUE.FAMILYNAME'].value;
   var NAMESUFFIX      = document.editForm.elements['N.'+i+'.VALUE.NAMESUFFIX'].value;
   var FN              = '';

   if (GIVENNAME != '' && FAMILYNAME != '' && GIVENNAME.match(is_asian)) {
      // order the FN for Chinese, Japanese, and Korean names
      FN += FAMILYNAME;
      FN += GIVENNAME;
      FN += ADDITIONALNAMES != '' ? ' ' + ADDITIONALNAMES : '';
   } else {
      FN += NAMEPREFIX != '' ? NAMEPREFIX + ' ' : '';
      FN += GIVENNAME != '' ? GIVENNAME + ' ' : '';
      FN += ADDITIONALNAMES != '' ? ADDITIONALNAMES + ' ' : '';
      FN += FAMILYNAME != '' ? FAMILYNAME + ' ' : '';
      FN += NAMESUFFIX;
   }

   document.editForm.elements['FN.'+i+'.VALUE'].value = FN;
}

function updateX_OWM_BDAY_AGE(caller) {
   // calculate and set the age from the year, month and day X-OWM-BDAY fields
   var caller_parts = caller.name.split('.');
   var i = caller_parts[1];

   var year  = validateYear(document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.YEAR'].value);
   var month = validateMonth(document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.MONTH'].value);
   var day   = validateDay(year,month,document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.DAY'].value);

   document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.YEAR'].value = year;
   document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.MONTH'].value = month;
   document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.DAY'].value = day;
   document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.AGE'].value = calculateAge(year,month,day);
}

function updateX_OWM_BDAY_YEAR(caller) {
   // calculate and set the year from an existing X-OWM-BDAY age field
   var caller_parts = caller.name.split('.');
   var i = caller_parts[1];

   var age   = document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.AGE'].value;
   var year  = validateYear(document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.YEAR'].value);
   var month = validateMonth(document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.MONTH'].value);
   var day   = validateDay(year,month,document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.DAY'].value);

   year = calculateYearFromAge(age,month,day);

   if (year != '') {
      document.editForm.elements['X-OWM-BDAY.'+i+'.VALUE.YEAR'].value = year;
   }
}

function updateX_OWM_BDAY(year,month,day) {
   // update the year, month, and day options with the selection from the X-OWM-BDAY calPopup
   // this function is called directly from the X-OWM-BDAY calPopup
   document.editForm.elements['X-OWM-BDAY.0.VALUE.YEAR'].value  = year;
   document.editForm.elements['X-OWM-BDAY.0.VALUE.MONTH'].value = month;
   document.editForm.elements['X-OWM-BDAY.0.VALUE.DAY'].value   = day;
   document.editForm.elements['X-OWM-BDAY.0.VALUE.AGE'].value   = calculateAge(year,month,day);
}

function calculateAge(year,month,day) {
   // given a year, month, and day, return the age in years
   year  = validateYear(year);
   month = validateMonth(month);
   day   = validateDay(year,month,day);

   if (isNaN(parseInt(year,10))) {
      return '';
   }

   var todayDate  = new Date();
   var todayYear  = todayDate.getFullYear();
   var todayMonth = todayDate.getMonth()+1;
   var todayDay   = todayDate.getDate();

   var age = todayYear - year;

   if (
        (!isNaN(parseInt(month,10)) && todayMonth < month)
        ||
        (!isNaN(parseInt(month,10)) && month == todayMonth && !isNaN(parseInt(day,10)) && todayDay < day)
      ) {
      age--; // birthday has not happened yet
   }

   return age;
}

function calculateYearFromAge(age,month,day) {
   // given an age, return the year
   if (isNaN(parseInt(age,10))) {
      return '';
   }

   month = (isNaN(parseInt(month,10))) ? 0 : month;
   day = (isNaN(parseInt(day,10))) ? 0 : day;

   var todayDate  = new Date();
   var todayYear  = todayDate.getFullYear();
   var todayMonth = todayDate.getMonth() + 1;
   var todayDay   = todayDate.getDate();

   var year = todayYear - age;

   if (todayMonth < month || (todayMonth == month && todayDay < day)) {
      year--; // birthday has not happened yet
   }

   return year;
}

function validateYear(year) {
   // make sure the year value is logical
   if (isNaN(parseInt(year,10))) {
      return '';
   } else if (year < 100) {
      year = 100;
   }

   return year;
}

function validateMonth(month) {
   // make sure the month value is logical
   if (isNaN(parseInt(month,10))) {
      return '';
   } else if (month > 12) {
      month = 12;
   } else if (month < 1) {
      month = 1;
   }

   return month;
}

function validateDay(year,month,day) {
   // make sure the day value is logical for the month in which it occurs
   var daysInMonth = new Array(0,31,28,31,30,31,30,31,31,30,31,30,31);

   if ((year % 4 == 0 && year % 100 != 0) || year % 400 == 0) {
      daysInMonth[2] = 29;
   }

   if (isNaN(parseInt(day,10))) {
      return '';
   } else if (day > daysInMonth[month]) {
      day = daysInMonth[month];
   } else if (day < 1) {
      day = 1;
   }

   return day;
}

function toggle_checkbox(name,value) {
   // given a field name and value, toggle the checkbox that matches
   for (var i=0; i<document.editForm.elements.length; i++) {
      var e = document.editForm.elements[i];
      if (e.type == 'checkbox' && e.name == name && e.value == value) {
         e.checked = !e.checked;
      }
   }
}

function update_map(count) {
   // given an address index count, update the google
   // map iframe using the data from the address fields
   var street            = document.editForm.elements['ADR.'+count+'.VALUE.STREET'].value;
   var extendedaddress   = document.editForm.elements['ADR.'+count+'.VALUE.EXTENDEDADDRESS'].value;
   var postofficeaddress = document.editForm.elements['ADR.'+count+'.VALUE.POSTOFFICEADDRESS'].value;
   var locality          = document.editForm.elements['ADR.'+count+'.VALUE.LOCALITY'].value;
   var region            = document.editForm.elements['ADR.'+count+'.VALUE.REGION'].value;
   var postalcode        = document.editForm.elements['ADR.'+count+'.VALUE.POSTALCODE'].value;
   var country           = document.editForm.elements['ADR.'+count+'.VALUE.COUNTRY'].value;

   var address = [street,extendedaddress,postofficeaddress,locality,region,postalcode,country];

   // update the map
   window.frames['map_'+count].location = 'http://maps.google.com/maps?q='+address.join()+'&iwloc=near&output=embed';

   // update the "view larger" link for the new map
   for(l = 0; l < document.links.length; l++) {
      if (document.links[l].name == 'viewlarger_'+count) {
         document.links[l].href = 'http://maps.google.com/maps?q='+address.join();
         break;
      }
   }

   return false;
}

function showGeo(count,show) {
   // popup photos or maps of specified longitudes and latitudes
   var longitude = document.editForm.elements['GEO.'+count+'.VALUE.LONGITUDE'].value;
   var latitude  = document.editForm.elements['GEO.'+count+'.VALUE.LATITUDE'].value;

   if (longitude != '' && latitude != '') {
      if (show == 'photo') {
         window.open('http://maps.google.com/maps?q='+latitude+','+longitude+'&t=h&z=19&output=embed','_showGeo','width=550,height=500,resizable=yes,scrollbars=yes');
      } else if (show == 'map') {
         window.open('http://maps.google.com/maps?q='+latitude+','+longitude+'&output=embed','_showGeo','width=550,height=500,resizable=yes,scrollbars=yes');
      }
   } else {
      alert('jgettext('You must fill in the longitude and latitude before any maps or photos can be viewed.')');
   }
}

function confirm_agent_action(message_option) {
   // provide confirm dialogs for actions performed on agents
   if (message_option == 'save') {
      return(confirm('jgettext('All data must be saved before viewing or creating an agent card. Save and continue?')'));
   } else if (message_option == 'cancel') {
      return(confirm('jgettext('All changes to this agent will be lost, continue?')'));
   }
}

function savecheck() {
   // ensure mandatory and recommended fields are filled in
   // before allowing the caller action to continue
   var givenname  = document.editForm.elements['N.0.VALUE.GIVENNAME'].value;
   var familyname = document.editForm.elements['N.0.VALUE.FAMILYNAME'].value;
   var email      = document.editForm.elements['EMAIL.0.VALUE'].value;

   if (givenname == '' && familyname == '') {
      alert("jgettext('Please fill in the first name or last name fields first.')");
      return false;
   }

   if (email == '') {
      return confirm("jgettext('The email address is empty. Continue?')");
   }

   return true;
}

<tmpl_if jumptolastchanged>
location.hash = '<tmpl_var jumptolastchanged escape="js">';
</tmpl_if>
// -->
</script>

<tmpl_var footer_template escape="none">

